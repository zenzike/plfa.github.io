---
src       : src/plfa/Compositional.lagda
title     : "Compositional: The denotational semantics is compositional"
layout    : page
prev      : /Denotational/
permalink : /Compositional/
next      : /Soundness/
---

<pre class="Agda">{% raw %}<a id="192" class="Keyword">module</a> <a id="199" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}" class="Module">plfa.Compositional</a> <a id="218" class="Keyword">where</a>{% endraw %}</pre>

## Imports

<pre class="Agda">{% raw %}<a id="261" class="Keyword">open</a> <a id="266" class="Keyword">import</a> <a id="273" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}" class="Module">plfa.Untyped</a>
<a id="286" class="Keyword">open</a> <a id="291" class="Keyword">import</a> <a id="298" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}" class="Module">plfa.Denotational</a>

<a id="317" class="Keyword">open</a> <a id="322" class="Keyword">import</a> <a id="329" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
  <a id="369" class="Keyword">using</a> <a id="375" class="Symbol">(</a><a id="376" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a><a id="379" class="Symbol">;</a> <a id="381" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.Core.html#660" class="Function Operator">_≢_</a><a id="384" class="Symbol">;</a> <a id="386" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="390" class="Symbol">;</a> <a id="392" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a><a id="395" class="Symbol">;</a> <a id="397" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a><a id="401" class="Symbol">;</a> <a id="403" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a><a id="408" class="Symbol">;</a> <a id="410" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a><a id="418" class="Symbol">)</a>
<a id="420" class="Keyword">open</a> <a id="425" class="Keyword">import</a> <a id="432" href="https://agda.github.io/agda-stdlib/Data.Product.html" class="Module">Data.Product</a> <a id="445" class="Keyword">using</a> <a id="451" class="Symbol">(</a><a id="452" href="https://agda.github.io/agda-stdlib/Data.Product.html#1353" class="Function Operator">_×_</a><a id="455" class="Symbol">;</a> <a id="457" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#69" class="Record">Σ</a><a id="458" class="Symbol">;</a> <a id="460" href="https://agda.github.io/agda-stdlib/Data.Product.html#764" class="Function">Σ-syntax</a><a id="468" class="Symbol">;</a> <a id="470" href="https://agda.github.io/agda-stdlib/Data.Product.html#881" class="Function">∃</a><a id="471" class="Symbol">;</a> <a id="473" href="https://agda.github.io/agda-stdlib/Data.Product.html#942" class="Function">∃-syntax</a><a id="481" class="Symbol">;</a> <a id="483" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#155" class="Field">proj₁</a><a id="488" class="Symbol">;</a> <a id="490" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#167" class="Field">proj₂</a><a id="495" class="Symbol">)</a>
  <a id="499" class="Keyword">renaming</a> <a id="508" class="Symbol">(</a><a id="509" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">_,_</a> <a id="513" class="Symbol">to</a> <a id="516" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨_,_⟩</a><a id="521" class="Symbol">)</a>
<a id="523" class="Keyword">open</a> <a id="528" class="Keyword">import</a> <a id="535" href="https://agda.github.io/agda-stdlib/Data.Sum.html" class="Module">Data.Sum</a>
<a id="544" class="Keyword">open</a> <a id="549" class="Keyword">import</a> <a id="556" href="https://agda.github.io/agda-stdlib/Agda.Primitive.html" class="Module">Agda.Primitive</a> <a id="571" class="Keyword">using</a> <a id="577" class="Symbol">(</a><a id="578" href="https://agda.github.io/agda-stdlib/Agda.Primitive.html#611" class="Primitive">lzero</a><a id="583" class="Symbol">)</a>
<a id="585" class="Keyword">open</a> <a id="590" class="Keyword">import</a> <a id="597" href="https://agda.github.io/agda-stdlib/Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="614" class="Keyword">using</a> <a id="620" class="Symbol">(</a><a id="621" href="https://agda.github.io/agda-stdlib/Relation.Nullary.html#464" class="Function Operator">¬_</a><a id="623" class="Symbol">)</a>
<a id="625" class="Keyword">open</a> <a id="630" class="Keyword">import</a> <a id="637" href="https://agda.github.io/agda-stdlib/Relation.Nullary.Negation.html" class="Module">Relation.Nullary.Negation</a> <a id="663" class="Keyword">using</a> <a id="669" class="Symbol">(</a><a id="670" href="https://agda.github.io/agda-stdlib/Relation.Nullary.Negation.html#560" class="Function">contradiction</a><a id="683" class="Symbol">)</a>
<a id="685" class="Keyword">open</a> <a id="690" class="Keyword">import</a> <a id="697" href="https://agda.github.io/agda-stdlib/Data.Empty.html" class="Module">Data.Empty</a> <a id="708" class="Keyword">using</a> <a id="714" class="Symbol">(</a><a id="715" href="https://agda.github.io/agda-stdlib/Data.Empty.html#360" class="Function">⊥-elim</a><a id="721" class="Symbol">)</a>
<a id="723" class="Keyword">open</a> <a id="728" class="Keyword">import</a> <a id="735" href="https://agda.github.io/agda-stdlib/Data.Unit.html" class="Module">Data.Unit</a>
<a id="745" class="Keyword">open</a> <a id="750" class="Keyword">import</a> <a id="757" href="https://agda.github.io/agda-stdlib/Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="774" class="Keyword">using</a> <a id="780" class="Symbol">(</a><a id="781" href="https://agda.github.io/agda-stdlib/Relation.Nullary.html#534" class="Datatype">Dec</a><a id="784" class="Symbol">;</a> <a id="786" href="https://agda.github.io/agda-stdlib/Relation.Nullary.html#570" class="InductiveConstructor">yes</a><a id="789" class="Symbol">;</a> <a id="791" href="https://agda.github.io/agda-stdlib/Relation.Nullary.html#597" class="InductiveConstructor">no</a><a id="793" class="Symbol">)</a>
<a id="795" class="Keyword">open</a> <a id="800" class="Keyword">import</a> <a id="807" href="https://agda.github.io/agda-stdlib/Function.html" class="Module">Function</a> <a id="816" class="Keyword">using</a> <a id="822" class="Symbol">(</a><a id="823" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">_∘_</a><a id="826" class="Symbol">)</a>
<a id="828" class="Comment">-- open import plfa.Isomorphism using (extensionality)  -- causes a bug!</a>{% endraw %}</pre>

## Compositionality

To prove that the denotational semantics is compositional, we need to
fill in the ellipses in the following equations.

    ℰ (ƛ M) ≃ ... ℰ M ...
    ℰ (M · N) ≃ ... ℰ M ... ℰ N ...

Regarding the first equation, we need a function that maps a
`Denotation (Γ , ★)` to a `Denotation Γ`. This function, let us name it `ℱ`,
should mimic the non-recursive part of the semantics when applied to a
lambda term.  In particular, we need to consider the rules `↦-intro`,
`⊥-intro`, and `⊔-intro`. So `ℱ` has three parameters, the denotation `D`
of the subterm `M`, an environment `γ`, and a value `v`.  If we define `ℱ` by
recursion on the value `v`, then it matches up nicely with the three
rules `↦-intro`, `⊥-intro`, and `⊔-intro`.

<pre class="Agda">{% raw %}<a id="ℱ"></a><a id="1674" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1674" class="Function">ℱ</a> <a id="1676" class="Symbol">:</a> <a id="1678" class="Symbol">∀{</a><a id="1680" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1680" class="Bound">Γ</a><a id="1681" class="Symbol">}</a> <a id="1683" class="Symbol">→</a> <a id="1685" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18105" class="Function">Denotation</a> <a id="1696" class="Symbol">(</a><a id="1697" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1680" class="Bound">Γ</a> <a id="1699" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3018" class="InductiveConstructor Operator">,</a> <a id="1701" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="1702" class="Symbol">)</a> <a id="1704" class="Symbol">→</a> <a id="1706" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18105" class="Function">Denotation</a> <a id="1717" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1680" class="Bound">Γ</a>
<a id="1719" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1674" class="Function">ℱ</a> <a id="1721" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1721" class="Bound">D</a> <a id="1723" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1723" class="Bound">γ</a> <a id="1725" class="Symbol">(</a><a id="1726" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1726" class="Bound">v₁</a> <a id="1729" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4129" class="InductiveConstructor Operator">↦</a> <a id="1731" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1731" class="Bound">v₂</a><a id="1733" class="Symbol">)</a> <a id="1735" class="Symbol">=</a> <a id="1737" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1721" class="Bound">D</a> <a id="1739" class="Symbol">(</a><a id="1740" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1723" class="Bound">γ</a> <a id="1742" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7489" class="Function Operator">`,</a> <a id="1745" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1726" class="Bound">v₁</a><a id="1747" class="Symbol">)</a> <a id="1749" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1731" class="Bound">v₂</a>
<a id="1752" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1674" class="Function">ℱ</a> <a id="1754" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1754" class="Bound">D</a> <a id="1756" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1756" class="Bound">γ</a> <a id="1758" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4117" class="InductiveConstructor">⊥</a> <a id="1760" class="Symbol">=</a> <a id="1762" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Unit.html#69" class="Record">⊤</a>
<a id="1764" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1674" class="Function">ℱ</a> <a id="1766" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1766" class="Bound">D</a> <a id="1768" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1768" class="Bound">γ</a> <a id="1770" class="Symbol">(</a><a id="1771" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1771" class="Bound">v₁</a> <a id="1774" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4159" class="InductiveConstructor Operator">⊔</a> <a id="1776" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1776" class="Bound">v₂</a><a id="1778" class="Symbol">)</a> <a id="1780" class="Symbol">=</a> <a id="1782" class="Symbol">(</a><a id="1783" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1674" class="Function">ℱ</a> <a id="1785" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1766" class="Bound">D</a> <a id="1787" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1768" class="Bound">γ</a> <a id="1789" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1771" class="Bound">v₁</a><a id="1791" class="Symbol">)</a> <a id="1793" href="https://agda.github.io/agda-stdlib/Data.Product.html#1353" class="Function Operator">×</a> <a id="1795" class="Symbol">(</a><a id="1796" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1674" class="Function">ℱ</a> <a id="1798" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1766" class="Bound">D</a> <a id="1800" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1768" class="Bound">γ</a> <a id="1802" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1776" class="Bound">v₂</a><a id="1804" class="Symbol">)</a>{% endraw %}</pre>

Using this `ℱ`, we hope to prove that

    ℰ (ƛ M) ≃ ℱ (ℰ M)

The function `ℱ` is preserved when going from a larger value `v` to a
smaller value `u`. The proof is a straightforward induction on the
derivation of `u ⊑ v`, using the `up-env` lemma in the case for the
`Fun⊑` rule.

<pre class="Agda">{% raw %}<a id="sub-ℱ"></a><a id="2112" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2112" class="Function">sub-ℱ</a> <a id="2118" class="Symbol">:</a> <a id="2120" class="Symbol">∀{</a><a id="2122" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2122" class="Bound">Γ</a><a id="2123" class="Symbol">}{</a><a id="2125" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2125" class="Bound">M</a> <a id="2127" class="Symbol">:</a> <a id="2129" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2122" class="Bound">Γ</a> <a id="2131" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3018" class="InductiveConstructor Operator">,</a> <a id="2133" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a> <a id="2135" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="2137" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="2138" class="Symbol">}{</a><a id="2140" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2140" class="Bound">γ</a> <a id="2142" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2142" class="Bound">v</a> <a id="2144" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2144" class="Bound">u</a><a id="2145" class="Symbol">}</a>
      <a id="2153" class="Symbol">→</a> <a id="2155" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1674" class="Function">ℱ</a> <a id="2157" class="Symbol">(</a><a id="2158" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="2160" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2125" class="Bound">M</a><a id="2161" class="Symbol">)</a> <a id="2163" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2140" class="Bound">γ</a> <a id="2165" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2142" class="Bound">v</a>
      <a id="2173" class="Symbol">→</a> <a id="2175" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2144" class="Bound">u</a> <a id="2177" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4468" class="Datatype Operator">⊑</a> <a id="2179" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2142" class="Bound">v</a>
        <a id="2189" class="Comment">------------</a>
      <a id="2208" class="Symbol">→</a> <a id="2210" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1674" class="Function">ℱ</a> <a id="2212" class="Symbol">(</a><a id="2213" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="2215" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2125" class="Bound">M</a><a id="2216" class="Symbol">)</a> <a id="2218" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2140" class="Bound">γ</a> <a id="2220" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2144" class="Bound">u</a>
<a id="2222" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2112" class="Function">sub-ℱ</a> <a id="2228" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2228" class="Bound">d</a> <a id="2230" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4503" class="InductiveConstructor">Bot⊑</a> <a id="2235" class="Symbol">=</a> <a id="2237" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Unit.html#106" class="InductiveConstructor">tt</a>
<a id="2240" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2112" class="Function">sub-ℱ</a> <a id="2246" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2246" class="Bound">d</a> <a id="2248" class="Symbol">(</a><a id="2249" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4839" class="InductiveConstructor">Fun⊑</a> <a id="2254" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2254" class="Bound">lt</a> <a id="2257" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2257" class="Bound">lt&#39;</a><a id="2260" class="Symbol">)</a> <a id="2262" class="Symbol">=</a> <a id="2264" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10462" class="InductiveConstructor">sub</a> <a id="2268" class="Symbol">(</a><a id="2269" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#26641" class="Function">up-env</a> <a id="2276" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2246" class="Bound">d</a> <a id="2278" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2254" class="Bound">lt</a><a id="2280" class="Symbol">)</a> <a id="2282" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2257" class="Bound">lt&#39;</a>
<a id="2286" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2112" class="Function">sub-ℱ</a> <a id="2292" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2292" class="Bound">d</a> <a id="2294" class="Symbol">(</a><a id="2295" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4527" class="InductiveConstructor">ConjL⊑</a> <a id="2302" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2302" class="Bound">lt</a> <a id="2305" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2305" class="Bound">lt₁</a><a id="2308" class="Symbol">)</a> <a id="2310" class="Symbol">=</a> <a id="2312" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="2314" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2112" class="Function">sub-ℱ</a> <a id="2320" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2292" class="Bound">d</a> <a id="2322" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2302" class="Bound">lt</a> <a id="2325" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2327" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2112" class="Function">sub-ℱ</a> <a id="2333" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2292" class="Bound">d</a> <a id="2335" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2305" class="Bound">lt₁</a> <a id="2339" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>
<a id="2341" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2112" class="Function">sub-ℱ</a> <a id="2347" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2347" class="Bound">d</a> <a id="2349" class="Symbol">(</a><a id="2350" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4617" class="InductiveConstructor">ConjR1⊑</a> <a id="2358" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2358" class="Bound">lt</a><a id="2360" class="Symbol">)</a> <a id="2362" class="Symbol">=</a> <a id="2364" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2112" class="Function">sub-ℱ</a> <a id="2370" class="Symbol">(</a><a id="2371" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#155" class="Field">proj₁</a> <a id="2377" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2347" class="Bound">d</a><a id="2378" class="Symbol">)</a> <a id="2380" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2358" class="Bound">lt</a>
<a id="2383" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2112" class="Function">sub-ℱ</a> <a id="2389" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2389" class="Bound">d</a> <a id="2391" class="Symbol">(</a><a id="2392" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4691" class="InductiveConstructor">ConjR2⊑</a> <a id="2400" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2400" class="Bound">lt</a><a id="2402" class="Symbol">)</a> <a id="2404" class="Symbol">=</a> <a id="2406" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2112" class="Function">sub-ℱ</a> <a id="2412" class="Symbol">(</a><a id="2413" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#167" class="Field">proj₂</a> <a id="2419" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2389" class="Bound">d</a><a id="2420" class="Symbol">)</a> <a id="2422" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2400" class="Bound">lt</a>
<a id="2425" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2112" class="Function">sub-ℱ</a> <a id="2431" class="Symbol">{</a><a id="2432" class="Argument">v</a> <a id="2434" class="Symbol">=</a> <a id="2436" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2436" class="Bound">v₁</a> <a id="2439" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4129" class="InductiveConstructor Operator">↦</a> <a id="2441" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2441" class="Bound">v₂</a> <a id="2444" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4159" class="InductiveConstructor Operator">⊔</a> <a id="2446" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2436" class="Bound">v₁</a> <a id="2449" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4129" class="InductiveConstructor Operator">↦</a> <a id="2451" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2451" class="Bound">v₃</a><a id="2453" class="Symbol">}</a> <a id="2455" class="Symbol">{</a><a id="2456" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2436" class="Bound">v₁</a> <a id="2459" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4129" class="InductiveConstructor Operator">↦</a> <a id="2461" class="Symbol">(</a><a id="2462" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2441" class="Bound">v₂</a> <a id="2465" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4159" class="InductiveConstructor Operator">⊔</a> <a id="2467" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2451" class="Bound">v₃</a><a id="2469" class="Symbol">)}</a> <a id="2472" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="2474" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2474" class="Bound">M2</a> <a id="2477" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2479" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2479" class="Bound">M3</a> <a id="2482" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="2484" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4953" class="InductiveConstructor">Dist⊑</a> <a id="2490" class="Symbol">=</a>
   <a id="2495" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10326" class="InductiveConstructor">⊔-intro</a> <a id="2503" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2474" class="Bound">M2</a> <a id="2506" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2479" class="Bound">M3</a>
<a id="2509" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2112" class="Function">sub-ℱ</a> <a id="2515" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2515" class="Bound">d</a> <a id="2517" class="Symbol">(</a><a id="2518" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4765" class="InductiveConstructor">Trans⊑</a> <a id="2525" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2525" class="Bound">x₁</a> <a id="2528" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2528" class="Bound">x₂</a><a id="2530" class="Symbol">)</a> <a id="2532" class="Symbol">=</a> <a id="2534" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2112" class="Function">sub-ℱ</a> <a id="2540" class="Symbol">(</a><a id="2541" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2112" class="Function">sub-ℱ</a> <a id="2547" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2515" class="Bound">d</a> <a id="2549" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2528" class="Bound">x₂</a><a id="2551" class="Symbol">)</a> <a id="2553" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2525" class="Bound">x₁</a>{% endraw %}</pre>

[PLW:
  If denotations were strengthened to be downward closed,
  we could rewrite the signature replacing (ℰ M) by d : Denotation (Γ , ★)]
  
With this subsumption property in hand, we can prove the forward
direction of the semantic equation for lambda.  The proof is by
induction on the semantics, using `sub-ℱ` in the case for the `sub`
rule.

<pre class="Agda">{% raw %}<a id="ℰƛ→ℱℰ"></a><a id="2928" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2928" class="Function">ℰƛ→ℱℰ</a> <a id="2934" class="Symbol">:</a> <a id="2936" class="Symbol">∀{</a><a id="2938" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2938" class="Bound">Γ</a><a id="2939" class="Symbol">}{</a><a id="2941" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2941" class="Bound">γ</a> <a id="2943" class="Symbol">:</a> <a id="2945" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7331" class="Function">Env</a> <a id="2949" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2938" class="Bound">Γ</a><a id="2950" class="Symbol">}{</a><a id="2952" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2952" class="Bound">M</a> <a id="2954" class="Symbol">:</a> <a id="2956" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2938" class="Bound">Γ</a> <a id="2958" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3018" class="InductiveConstructor Operator">,</a> <a id="2960" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a> <a id="2962" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="2964" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="2965" class="Symbol">}{</a><a id="2967" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2967" class="Bound">v</a> <a id="2969" class="Symbol">:</a> <a id="2971" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4097" class="Datatype">Value</a><a id="2976" class="Symbol">}</a>
        <a id="2986" class="Symbol">→</a> <a id="2988" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="2990" class="Symbol">(</a><a id="2991" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4238" class="InductiveConstructor Operator">ƛ</a> <a id="2993" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2952" class="Bound">M</a><a id="2994" class="Symbol">)</a> <a id="2996" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2941" class="Bound">γ</a> <a id="2998" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2967" class="Bound">v</a>
          <a id="3010" class="Comment">------------</a>
        <a id="3031" class="Symbol">→</a> <a id="3033" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1674" class="Function">ℱ</a> <a id="3035" class="Symbol">(</a><a id="3036" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="3038" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2952" class="Bound">M</a><a id="3039" class="Symbol">)</a> <a id="3041" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2941" class="Bound">γ</a> <a id="3043" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2967" class="Bound">v</a>
<a id="3045" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2928" class="Function">ℰƛ→ℱℰ</a> <a id="3051" class="Symbol">(</a><a id="3052" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10127" class="InductiveConstructor">↦-intro</a> <a id="3060" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3060" class="Bound">d</a><a id="3061" class="Symbol">)</a> <a id="3063" class="Symbol">=</a> <a id="3065" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3060" class="Bound">d</a>
<a id="3067" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2928" class="Function">ℰƛ→ℱℰ</a> <a id="3073" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10251" class="InductiveConstructor">⊥-intro</a> <a id="3081" class="Symbol">=</a> <a id="3083" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Unit.html#106" class="InductiveConstructor">tt</a>
<a id="3086" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2928" class="Function">ℰƛ→ℱℰ</a> <a id="3092" class="Symbol">(</a><a id="3093" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10326" class="InductiveConstructor">⊔-intro</a> <a id="3101" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3101" class="Bound">d₁</a> <a id="3104" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3104" class="Bound">d₂</a><a id="3106" class="Symbol">)</a> <a id="3108" class="Symbol">=</a> <a id="3110" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="3112" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2928" class="Function">ℰƛ→ℱℰ</a> <a id="3118" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3101" class="Bound">d₁</a> <a id="3121" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3123" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2928" class="Function">ℰƛ→ℱℰ</a> <a id="3129" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3104" class="Bound">d₂</a> <a id="3132" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>
<a id="3134" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2928" class="Function">ℰƛ→ℱℰ</a> <a id="3140" class="Symbol">(</a><a id="3141" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10462" class="InductiveConstructor">sub</a> <a id="3145" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3145" class="Bound">d</a> <a id="3147" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3147" class="Bound">lt</a><a id="3149" class="Symbol">)</a> <a id="3151" class="Symbol">=</a> <a id="3153" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2112" class="Function">sub-ℱ</a> <a id="3159" class="Symbol">(</a><a id="3160" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2928" class="Function">ℰƛ→ℱℰ</a> <a id="3166" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3145" class="Bound">d</a><a id="3167" class="Symbol">)</a> <a id="3169" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3147" class="Bound">lt</a>{% endraw %}</pre>

The "inversion lemma" for lambda abstraction is a special case of the
above. The inversion lemma is useful in proving that denotations are
preserved by reduction.

<pre class="Agda">{% raw %}<a id="lambda-inversion"></a><a id="3361" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3361" class="Function">lambda-inversion</a> <a id="3378" class="Symbol">:</a> <a id="3380" class="Symbol">∀{</a><a id="3382" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3382" class="Bound">Γ</a><a id="3383" class="Symbol">}{</a><a id="3385" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3385" class="Bound">γ</a> <a id="3387" class="Symbol">:</a> <a id="3389" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7331" class="Function">Env</a> <a id="3393" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3382" class="Bound">Γ</a><a id="3394" class="Symbol">}{</a><a id="3396" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3396" class="Bound">M</a> <a id="3398" class="Symbol">:</a> <a id="3400" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3382" class="Bound">Γ</a> <a id="3402" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3018" class="InductiveConstructor Operator">,</a> <a id="3404" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a> <a id="3406" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="3408" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="3409" class="Symbol">}{</a><a id="3411" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3411" class="Bound">v₁</a> <a id="3414" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3414" class="Bound">v₂</a> <a id="3417" class="Symbol">:</a> <a id="3419" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4097" class="Datatype">Value</a><a id="3424" class="Symbol">}</a>
  <a id="3428" class="Symbol">→</a> <a id="3430" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3385" class="Bound">γ</a> <a id="3432" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9856" class="Datatype Operator">⊢</a> <a id="3434" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4238" class="InductiveConstructor Operator">ƛ</a> <a id="3436" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3396" class="Bound">M</a> <a id="3438" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9856" class="Datatype Operator">↓</a> <a id="3440" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3411" class="Bound">v₁</a> <a id="3443" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4129" class="InductiveConstructor Operator">↦</a> <a id="3445" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3414" class="Bound">v₂</a>
    <a id="3452" class="Comment">-----------------</a>
  <a id="3472" class="Symbol">→</a> <a id="3474" class="Symbol">(</a><a id="3475" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3385" class="Bound">γ</a> <a id="3477" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7489" class="Function Operator">`,</a> <a id="3480" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3411" class="Bound">v₁</a><a id="3482" class="Symbol">)</a> <a id="3484" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9856" class="Datatype Operator">⊢</a> <a id="3486" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3396" class="Bound">M</a> <a id="3488" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9856" class="Datatype Operator">↓</a> <a id="3490" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3414" class="Bound">v₂</a>
<a id="3493" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3361" class="Function">lambda-inversion</a><a id="3509" class="Symbol">{</a><a id="3510" class="Argument">v₁</a> <a id="3513" class="Symbol">=</a> <a id="3515" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3515" class="Bound">v₁</a><a id="3517" class="Symbol">}{</a><a id="3519" class="Argument">v₂</a> <a id="3522" class="Symbol">=</a> <a id="3524" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3524" class="Bound">v₂</a><a id="3526" class="Symbol">}</a> <a id="3528" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3528" class="Bound">d</a> <a id="3530" class="Symbol">=</a> <a id="3532" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2928" class="Function">ℰƛ→ℱℰ</a><a id="3537" class="Symbol">{</a><a id="3538" class="Argument">v</a> <a id="3540" class="Symbol">=</a> <a id="3542" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3515" class="Bound">v₁</a> <a id="3545" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4129" class="InductiveConstructor Operator">↦</a> <a id="3547" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3524" class="Bound">v₂</a><a id="3549" class="Symbol">}</a> <a id="3551" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3528" class="Bound">d</a>{% endraw %}</pre>

The backward direction of the semantic equation for lambda is even
easier to prove than the forward direction. We proceed by induction on
the value v.

<pre class="Agda">{% raw %}<a id="ℱℰ→ℰƛ"></a><a id="3730" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3730" class="Function">ℱℰ→ℰƛ</a> <a id="3736" class="Symbol">:</a> <a id="3738" class="Symbol">∀{</a><a id="3740" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3740" class="Bound">Γ</a><a id="3741" class="Symbol">}{</a><a id="3743" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3743" class="Bound">γ</a> <a id="3745" class="Symbol">:</a> <a id="3747" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7331" class="Function">Env</a> <a id="3751" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3740" class="Bound">Γ</a><a id="3752" class="Symbol">}{</a><a id="3754" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3754" class="Bound">M</a> <a id="3756" class="Symbol">:</a> <a id="3758" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3740" class="Bound">Γ</a> <a id="3760" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3018" class="InductiveConstructor Operator">,</a> <a id="3762" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a> <a id="3764" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="3766" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="3767" class="Symbol">}{</a><a id="3769" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3769" class="Bound">v</a> <a id="3771" class="Symbol">:</a> <a id="3773" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4097" class="Datatype">Value</a><a id="3778" class="Symbol">}</a>
        <a id="3788" class="Symbol">→</a> <a id="3790" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1674" class="Function">ℱ</a> <a id="3792" class="Symbol">(</a><a id="3793" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="3795" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3754" class="Bound">M</a><a id="3796" class="Symbol">)</a> <a id="3798" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3743" class="Bound">γ</a> <a id="3800" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3769" class="Bound">v</a>
          <a id="3812" class="Comment">------------</a>
        <a id="3833" class="Symbol">→</a> <a id="3835" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="3837" class="Symbol">(</a><a id="3838" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4238" class="InductiveConstructor Operator">ƛ</a> <a id="3840" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3754" class="Bound">M</a><a id="3841" class="Symbol">)</a> <a id="3843" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3743" class="Bound">γ</a> <a id="3845" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3769" class="Bound">v</a>
<a id="3847" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3730" class="Function">ℱℰ→ℰƛ</a> <a id="3853" class="Symbol">{</a><a id="3854" class="Argument">v</a> <a id="3856" class="Symbol">=</a> <a id="3858" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4117" class="InductiveConstructor">⊥</a><a id="3859" class="Symbol">}</a> <a id="3861" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3861" class="Bound">d</a> <a id="3863" class="Symbol">=</a> <a id="3865" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10251" class="InductiveConstructor">⊥-intro</a>
<a id="3873" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3730" class="Function">ℱℰ→ℰƛ</a> <a id="3879" class="Symbol">{</a><a id="3880" class="Argument">v</a> <a id="3882" class="Symbol">=</a> <a id="3884" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3884" class="Bound">v₁</a> <a id="3887" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4129" class="InductiveConstructor Operator">↦</a> <a id="3889" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3889" class="Bound">v₂</a><a id="3891" class="Symbol">}</a> <a id="3893" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3893" class="Bound">d</a> <a id="3895" class="Symbol">=</a> <a id="3897" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10127" class="InductiveConstructor">↦-intro</a> <a id="3905" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3893" class="Bound">d</a>
<a id="3907" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3730" class="Function">ℱℰ→ℰƛ</a> <a id="3913" class="Symbol">{</a><a id="3914" class="Argument">v</a> <a id="3916" class="Symbol">=</a> <a id="3918" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3918" class="Bound">v₁</a> <a id="3921" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4159" class="InductiveConstructor Operator">⊔</a> <a id="3923" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3923" class="Bound">v₂</a><a id="3925" class="Symbol">}</a> <a id="3927" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="3929" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3929" class="Bound">d1</a> <a id="3932" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3934" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3934" class="Bound">d2</a> <a id="3937" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="3939" class="Symbol">=</a> <a id="3941" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10326" class="InductiveConstructor">⊔-intro</a> <a id="3949" class="Symbol">(</a><a id="3950" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3730" class="Function">ℱℰ→ℰƛ</a> <a id="3956" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3929" class="Bound">d1</a><a id="3958" class="Symbol">)</a> <a id="3960" class="Symbol">(</a><a id="3961" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3730" class="Function">ℱℰ→ℰƛ</a> <a id="3967" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3934" class="Bound">d2</a><a id="3969" class="Symbol">)</a>{% endraw %}</pre>

So indeed, the denotational semantics is composititional with respect
to lambda abstraction, as witnessed by the function `ℱ`.

<pre class="Agda">{% raw %}<a id="lam-equiv"></a><a id="4124" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#4124" class="Function">lam-equiv</a> <a id="4134" class="Symbol">:</a> <a id="4136" class="Symbol">∀{</a><a id="4138" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#4138" class="Bound">Γ</a><a id="4139" class="Symbol">}{</a><a id="4141" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#4141" class="Bound">γ</a> <a id="4143" class="Symbol">:</a> <a id="4145" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7331" class="Function">Env</a> <a id="4149" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#4138" class="Bound">Γ</a><a id="4150" class="Symbol">}{</a><a id="4152" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#4152" class="Bound">M</a> <a id="4154" class="Symbol">:</a> <a id="4156" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#4138" class="Bound">Γ</a> <a id="4158" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3018" class="InductiveConstructor Operator">,</a> <a id="4160" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a> <a id="4162" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="4164" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="4165" class="Symbol">}</a>
          <a id="4177" class="Symbol">→</a> <a id="4179" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="4181" class="Symbol">(</a><a id="4182" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4238" class="InductiveConstructor Operator">ƛ</a> <a id="4184" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#4152" class="Bound">M</a><a id="4185" class="Symbol">)</a> <a id="4187" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18532" class="Function Operator">≃</a> <a id="4189" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#1674" class="Function">ℱ</a> <a id="4191" class="Symbol">(</a><a id="4192" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="4194" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#4152" class="Bound">M</a><a id="4195" class="Symbol">)</a>
<a id="4197" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#4124" class="Function">lam-equiv</a> <a id="4207" class="Symbol">=</a> <a id="4209" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="4211" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#2928" class="Function">ℰƛ→ℱℰ</a> <a id="4217" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="4219" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3730" class="Function">ℱℰ→ℰƛ</a> <a id="4225" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>{% endraw %}</pre>

Next we consider function application. For this we need to define a
function that takes two denotations, both in context `Γ`, and produces
another one in context `Γ`. This function, let us name it `●`, needs to
mimic the non-recursive aspects of the semantics of an application `L · M`.
We cannot proceed as easily as for `ℱ` and define the function by
recursion on value `v` because, for example, the rule `↦-elim` applies
to any value. Instead we shall define `●` in a way that directly deals
with the `↦-elim` and `⊥-intro` rules but ignores `⊔-intro`. This
makes the forward direction of the proof more difficult, and the case
for `⊔-intro` demonstrates why the `Dist⊑` rule is important.

So we define the application of `D₁` to `D₂`, written `D₁ ● D₂`, to include
any value `w` equivalent to `⊥`, for the `⊥-intro` rule, and to include any
value `w` that is the output of an entry `v ↦ w` in `D₁`, provided the
input `v` is in `D₂`, for the `↦-elim` rule.

<pre class="Agda">{% raw %}<a id="5215" class="Keyword">infixl</a> <a id="5222" class="Number">7</a> <a id="5224" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5229" class="Function Operator">_●_</a>

<a id="_●_"></a><a id="5229" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5229" class="Function Operator">_●_</a> <a id="5233" class="Symbol">:</a> <a id="5235" class="Symbol">∀{</a><a id="5237" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5237" class="Bound">Γ</a><a id="5238" class="Symbol">}</a> <a id="5240" class="Symbol">→</a> <a id="5242" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18105" class="Function">Denotation</a> <a id="5253" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5237" class="Bound">Γ</a> <a id="5255" class="Symbol">→</a> <a id="5257" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18105" class="Function">Denotation</a> <a id="5268" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5237" class="Bound">Γ</a> <a id="5270" class="Symbol">→</a> <a id="5272" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18105" class="Function">Denotation</a> <a id="5283" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5237" class="Bound">Γ</a>
<a id="5285" class="Symbol">(</a><a id="5286" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5286" class="Bound">D₁</a> <a id="5289" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5229" class="Function Operator">●</a> <a id="5291" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5291" class="Bound">D₂</a><a id="5293" class="Symbol">)</a> <a id="5295" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5295" class="Bound">γ</a> <a id="5297" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5297" class="Bound">w</a> <a id="5299" class="Symbol">=</a> <a id="5301" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5297" class="Bound">w</a> <a id="5303" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4468" class="Datatype Operator">⊑</a> <a id="5305" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4117" class="InductiveConstructor">⊥</a> <a id="5307" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#419" class="Datatype Operator">⊎</a> <a id="5309" href="https://agda.github.io/agda-stdlib/Data.Product.html#764" class="Function">Σ[</a> <a id="5312" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5312" class="Bound">v</a> <a id="5314" href="https://agda.github.io/agda-stdlib/Data.Product.html#764" class="Function">∈</a> <a id="5316" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4097" class="Datatype">Value</a> <a id="5322" href="https://agda.github.io/agda-stdlib/Data.Product.html#764" class="Function">]</a><a id="5323" class="Symbol">(</a> <a id="5325" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5286" class="Bound">D₁</a> <a id="5328" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5295" class="Bound">γ</a> <a id="5330" class="Symbol">(</a><a id="5331" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5312" class="Bound">v</a> <a id="5333" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4129" class="InductiveConstructor Operator">↦</a> <a id="5335" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5297" class="Bound">w</a><a id="5336" class="Symbol">)</a> <a id="5338" href="https://agda.github.io/agda-stdlib/Data.Product.html#1353" class="Function Operator">×</a> <a id="5340" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5291" class="Bound">D₂</a> <a id="5343" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5295" class="Bound">γ</a> <a id="5345" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5312" class="Bound">v</a> <a id="5347" class="Symbol">)</a>{% endraw %}</pre>

Next we consider the inversion lemma for application, which is also
the forward direction of the semantic equation for application.  We
describe the proof below.

<pre class="Agda">{% raw %}<a id="ℰ·→●ℰ"></a><a id="5537" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5537" class="Function">ℰ·→●ℰ</a> <a id="5543" class="Symbol">:</a> <a id="5545" class="Symbol">∀{</a><a id="5547" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5547" class="Bound">Γ</a><a id="5548" class="Symbol">}{</a><a id="5550" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5550" class="Bound">γ</a> <a id="5552" class="Symbol">:</a> <a id="5554" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7331" class="Function">Env</a> <a id="5558" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5547" class="Bound">Γ</a><a id="5559" class="Symbol">}{</a><a id="5561" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5561" class="Bound">L</a> <a id="5563" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5563" class="Bound">M</a> <a id="5565" class="Symbol">:</a> <a id="5567" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5547" class="Bound">Γ</a> <a id="5569" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="5571" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="5572" class="Symbol">}{</a><a id="5574" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5574" class="Bound">v</a> <a id="5576" class="Symbol">:</a> <a id="5578" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4097" class="Datatype">Value</a><a id="5583" class="Symbol">}</a>
        <a id="5593" class="Symbol">→</a> <a id="5595" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="5597" class="Symbol">(</a><a id="5598" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5561" class="Bound">L</a> <a id="5600" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4298" class="InductiveConstructor Operator">·</a> <a id="5602" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5563" class="Bound">M</a><a id="5603" class="Symbol">)</a> <a id="5605" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5550" class="Bound">γ</a> <a id="5607" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5574" class="Bound">v</a>
          <a id="5619" class="Comment">----------------</a>
        <a id="5644" class="Symbol">→</a> <a id="5646" class="Symbol">(</a><a id="5647" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="5649" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5561" class="Bound">L</a> <a id="5651" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5229" class="Function Operator">●</a> <a id="5653" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="5655" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5563" class="Bound">M</a><a id="5656" class="Symbol">)</a> <a id="5658" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5550" class="Bound">γ</a> <a id="5660" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5574" class="Bound">v</a>
<a id="5662" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5537" class="Function">ℰ·→●ℰ</a> <a id="5668" class="Symbol">(</a><a id="5669" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9989" class="InductiveConstructor">↦-elim</a><a id="5675" class="Symbol">{</a><a id="5676" class="Argument">v</a> <a id="5678" class="Symbol">=</a> <a id="5680" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5680" class="Bound">v&#39;</a><a id="5682" class="Symbol">}</a> <a id="5684" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5684" class="Bound">d₁</a> <a id="5687" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5687" class="Bound">d₂</a><a id="5689" class="Symbol">)</a> <a id="5691" class="Symbol">=</a> <a id="5693" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="5698" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="5700" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5680" class="Bound">v&#39;</a> <a id="5703" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="5705" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="5707" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5684" class="Bound">d₁</a> <a id="5710" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="5712" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5687" class="Bound">d₂</a> <a id="5715" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="5717" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>
<a id="5719" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5537" class="Function">ℰ·→●ℰ</a> <a id="5725" class="Symbol">{</a><a id="5726" class="Argument">v</a> <a id="5728" class="Symbol">=</a> <a id="5730" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4117" class="InductiveConstructor">⊥</a><a id="5731" class="Symbol">}</a> <a id="5733" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10251" class="InductiveConstructor">⊥-intro</a> <a id="5741" class="Symbol">=</a> <a id="5743" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="5748" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4503" class="InductiveConstructor">Bot⊑</a>
<a id="5753" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5537" class="Function">ℰ·→●ℰ</a> <a id="5759" class="Symbol">{</a><a id="5760" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5760" class="Bound">Γ</a><a id="5761" class="Symbol">}{</a><a id="5763" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5763" class="Bound">γ</a><a id="5764" class="Symbol">}{</a><a id="5766" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5766" class="Bound">L</a><a id="5767" class="Symbol">}{</a><a id="5769" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5769" class="Bound">M</a><a id="5770" class="Symbol">}{</a><a id="5772" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5772" class="Bound">v</a><a id="5773" class="Symbol">}</a> <a id="5775" class="Symbol">(</a><a id="5776" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10326" class="InductiveConstructor">⊔-intro</a><a id="5783" class="Symbol">{</a><a id="5784" class="Argument">v</a> <a id="5786" class="Symbol">=</a> <a id="5788" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5788" class="Bound">v₁</a><a id="5790" class="Symbol">}{</a><a id="5792" class="Argument">w</a> <a id="5794" class="Symbol">=</a> <a id="5796" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5796" class="Bound">v₂</a><a id="5798" class="Symbol">}</a> <a id="5800" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5800" class="Bound">d₁</a> <a id="5803" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5803" class="Bound">d₂</a><a id="5805" class="Symbol">)</a> 
    <a id="5812" class="Keyword">with</a> <a id="5817" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5537" class="Function">ℰ·→●ℰ</a> <a id="5823" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5800" class="Bound">d₁</a> <a id="5826" class="Symbol">|</a> <a id="5828" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5537" class="Function">ℰ·→●ℰ</a> <a id="5834" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5803" class="Bound">d₂</a>
<a id="5837" class="Symbol">...</a> <a id="5841" class="Symbol">|</a> <a id="5843" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="5848" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5848" class="Bound">lt1</a> <a id="5852" class="Symbol">|</a> <a id="5854" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="5859" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5859" class="Bound">lt2</a> <a id="5863" class="Symbol">=</a> <a id="5865" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="5870" class="Symbol">(</a><a id="5871" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4527" class="InductiveConstructor">ConjL⊑</a> <a id="5878" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5848" class="Bound">lt1</a> <a id="5882" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5859" class="Bound">lt2</a><a id="5885" class="Symbol">)</a>    
<a id="5891" class="Symbol">...</a> <a id="5895" class="Symbol">|</a> <a id="5897" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="5902" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5902" class="Bound">lt1</a> <a id="5906" class="Symbol">|</a> <a id="5908" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="5913" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="5915" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5915" class="Bound">v₁&#39;</a> <a id="5919" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="5921" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="5923" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5923" class="Bound">L↓v12</a> <a id="5929" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="5931" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5931" class="Bound">M↓v3</a> <a id="5936" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="5938" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="5940" class="Symbol">=</a>
      <a id="5948" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="5953" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="5955" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5915" class="Bound">v₁&#39;</a> <a id="5959" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="5961" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="5963" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10462" class="InductiveConstructor">sub</a> <a id="5967" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5923" class="Bound">L↓v12</a> <a id="5973" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5999" class="Function">lt</a> <a id="5976" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="5978" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5931" class="Bound">M↓v3</a> <a id="5983" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="5985" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>
      <a id="5993" class="Keyword">where</a> <a id="5999" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5999" class="Function">lt</a> <a id="6002" class="Symbol">:</a> <a id="6004" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5915" class="Bound">v₁&#39;</a> <a id="6008" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4129" class="InductiveConstructor Operator">↦</a> <a id="6010" class="Symbol">(</a><a id="6011" class="Bound">v₁</a> <a id="6014" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4159" class="InductiveConstructor Operator">⊔</a> <a id="6016" class="Bound">v₂</a><a id="6018" class="Symbol">)</a> <a id="6020" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4468" class="Datatype Operator">⊑</a> <a id="6022" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5915" class="Bound">v₁&#39;</a> <a id="6026" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4129" class="InductiveConstructor Operator">↦</a> <a id="6028" class="Bound">v₂</a>
            <a id="6043" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5999" class="Function">lt</a> <a id="6046" class="Symbol">=</a> <a id="6048" class="Symbol">(</a><a id="6049" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4839" class="InductiveConstructor">Fun⊑</a> <a id="6054" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#5638" class="Function">Refl⊑</a> <a id="6060" class="Symbol">(</a><a id="6061" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4527" class="InductiveConstructor">ConjL⊑</a> <a id="6068" class="Symbol">(</a><a id="6069" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4765" class="InductiveConstructor">Trans⊑</a> <a id="6076" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5902" class="Bound">lt1</a> <a id="6080" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4503" class="InductiveConstructor">Bot⊑</a><a id="6084" class="Symbol">)</a> <a id="6086" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#5638" class="Function">Refl⊑</a><a id="6091" class="Symbol">))</a>
<a id="6094" class="Symbol">...</a> <a id="6098" class="Symbol">|</a> <a id="6100" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="6105" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6107" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6107" class="Bound">v₁&#39;</a> <a id="6111" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6113" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6115" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6115" class="Bound">L↓v12</a> <a id="6121" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6123" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6123" class="Bound">M↓v3</a> <a id="6128" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6130" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6132" class="Symbol">|</a> <a id="6134" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="6139" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6139" class="Bound">lt2</a> <a id="6143" class="Symbol">=</a>
      <a id="6151" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="6156" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6158" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6107" class="Bound">v₁&#39;</a> <a id="6162" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6164" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6166" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10462" class="InductiveConstructor">sub</a> <a id="6170" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6115" class="Bound">L↓v12</a> <a id="6176" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6202" class="Function">lt</a> <a id="6179" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6181" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6123" class="Bound">M↓v3</a> <a id="6186" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6188" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>
      <a id="6196" class="Keyword">where</a> <a id="6202" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6202" class="Function">lt</a> <a id="6205" class="Symbol">:</a> <a id="6207" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6107" class="Bound">v₁&#39;</a> <a id="6211" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4129" class="InductiveConstructor Operator">↦</a> <a id="6213" class="Symbol">(</a><a id="6214" class="Bound">v₁</a> <a id="6217" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4159" class="InductiveConstructor Operator">⊔</a> <a id="6219" class="Bound">v₂</a><a id="6221" class="Symbol">)</a> <a id="6223" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4468" class="Datatype Operator">⊑</a> <a id="6225" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6107" class="Bound">v₁&#39;</a> <a id="6229" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4129" class="InductiveConstructor Operator">↦</a> <a id="6231" class="Bound">v₁</a>
            <a id="6246" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6202" class="Function">lt</a> <a id="6249" class="Symbol">=</a> <a id="6251" class="Symbol">(</a><a id="6252" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4839" class="InductiveConstructor">Fun⊑</a> <a id="6257" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#5638" class="Function">Refl⊑</a> <a id="6263" class="Symbol">(</a><a id="6264" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4527" class="InductiveConstructor">ConjL⊑</a> <a id="6271" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#5638" class="Function">Refl⊑</a> <a id="6277" class="Symbol">(</a><a id="6278" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4765" class="InductiveConstructor">Trans⊑</a> <a id="6285" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6139" class="Bound">lt2</a> <a id="6289" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4503" class="InductiveConstructor">Bot⊑</a><a id="6293" class="Symbol">)))</a>
<a id="6297" class="Symbol">...</a> <a id="6301" class="Symbol">|</a> <a id="6303" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="6308" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6310" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6310" class="Bound">v₁&#39;</a> <a id="6314" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6316" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6318" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6318" class="Bound">L↓v12</a> <a id="6324" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6326" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6326" class="Bound">M↓v3</a> <a id="6331" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6333" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6335" class="Symbol">|</a> <a id="6337" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="6342" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6344" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6344" class="Bound">v₁&#39;&#39;</a> <a id="6349" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6351" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6353" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6353" class="Bound">L↓v12&#39;</a> <a id="6360" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6362" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6362" class="Bound">M↓v3&#39;</a> <a id="6368" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6370" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6372" class="Symbol">=</a>
      <a id="6380" class="Keyword">let</a> <a id="6384" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6384" class="Bound">L↓⊔</a> <a id="6388" class="Symbol">=</a> <a id="6390" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10326" class="InductiveConstructor">⊔-intro</a> <a id="6398" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6318" class="Bound">L↓v12</a> <a id="6404" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6353" class="Bound">L↓v12&#39;</a> <a id="6411" class="Keyword">in</a>
      <a id="6420" class="Keyword">let</a> <a id="6424" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6424" class="Bound">M↓⊔</a> <a id="6428" class="Symbol">=</a> <a id="6430" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10326" class="InductiveConstructor">⊔-intro</a> <a id="6438" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6326" class="Bound">M↓v3</a> <a id="6443" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6362" class="Bound">M↓v3&#39;</a> <a id="6449" class="Keyword">in</a>
      <a id="6458" class="Keyword">let</a> <a id="6462" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6462" class="Bound">x</a> <a id="6464" class="Symbol">=</a> <a id="6466" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="6471" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6473" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6310" class="Bound">v₁&#39;</a> <a id="6477" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4159" class="InductiveConstructor Operator">⊔</a> <a id="6479" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6344" class="Bound">v₁&#39;&#39;</a> <a id="6484" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6486" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6488" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10462" class="InductiveConstructor">sub</a> <a id="6492" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6384" class="Bound">L↓⊔</a> <a id="6496" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#6293" class="Function">Dist⊔↦⊔</a> <a id="6504" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6506" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6424" class="Bound">M↓⊔</a> <a id="6510" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6512" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6514" class="Keyword">in</a>
      <a id="6523" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6462" class="Bound">x</a>
<a id="6525" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5537" class="Function">ℰ·→●ℰ</a> <a id="6531" class="Symbol">{</a><a id="6532" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6532" class="Bound">Γ</a><a id="6533" class="Symbol">}{</a><a id="6535" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6535" class="Bound">γ</a><a id="6536" class="Symbol">}{</a><a id="6538" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6538" class="Bound">L</a><a id="6539" class="Symbol">}{</a><a id="6541" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6541" class="Bound">M</a><a id="6542" class="Symbol">}{</a><a id="6544" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6544" class="Bound">v</a><a id="6545" class="Symbol">}</a> <a id="6547" class="Symbol">(</a><a id="6548" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10462" class="InductiveConstructor">sub</a> <a id="6552" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6552" class="Bound">d</a> <a id="6554" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6554" class="Bound">lt</a><a id="6556" class="Symbol">)</a>
    <a id="6562" class="Keyword">with</a> <a id="6567" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5537" class="Function">ℰ·→●ℰ</a> <a id="6573" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6552" class="Bound">d</a>
<a id="6575" class="Symbol">...</a> <a id="6579" class="Symbol">|</a> <a id="6581" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="6586" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6586" class="Bound">lt2</a> <a id="6590" class="Symbol">=</a> <a id="6592" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="6597" class="Symbol">(</a><a id="6598" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4765" class="InductiveConstructor">Trans⊑</a> <a id="6605" class="Bound">lt</a> <a id="6608" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6586" class="Bound">lt2</a><a id="6611" class="Symbol">)</a>
<a id="6613" class="Symbol">...</a> <a id="6617" class="Symbol">|</a> <a id="6619" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="6624" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6626" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6626" class="Bound">v₁</a> <a id="6629" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6631" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6633" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6633" class="Bound">L↓v12</a> <a id="6639" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6641" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6641" class="Bound">M↓v3</a> <a id="6646" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6648" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6650" class="Symbol">=</a>
      <a id="6658" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="6663" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6665" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6626" class="Bound">v₁</a> <a id="6668" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6670" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6672" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10462" class="InductiveConstructor">sub</a> <a id="6676" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6633" class="Bound">L↓v12</a> <a id="6682" class="Symbol">(</a><a id="6683" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4839" class="InductiveConstructor">Fun⊑</a> <a id="6688" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#5638" class="Function">Refl⊑</a> <a id="6694" class="Bound">lt</a><a id="6696" class="Symbol">)</a> <a id="6698" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6700" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#6641" class="Bound">M↓v3</a> <a id="6705" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6707" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>{% endraw %}</pre>

We proceed by induction on the semantics.

* In case `↦-elim` we have `γ ⊢ L ↓ (v' ↦ v)` and `γ ⊢ M ↓ v'`,
  which is all we need to show `(ℰ L ● ℰ M) γ v`.

* In case `⊥-intro` we have `v = ⊥`. We conclude that `v ⊑ ⊥`.

* In case `⊔-intro` we have `ℰ (L · M) γ v₁` and `ℰ (L · M) γ v₂`
  and need to show `(ℰ L ● ℰ M) γ (v₁ ⊔ v₂)`. By the induction
  hypothesis, we have `(ℰ L ● ℰ M) γ v₁` and `(ℰ L ● ℰ M) γ v₂`.
  We have four subcases to consider.

    * Suppose `v₁ ⊑ ⊥` and `v₂ ⊑ ⊥`. Then `v₁ ⊔ v₂ ⊑ ⊥`.
    * Suppose `v₁ ⊑ ⊥`, `γ ⊢ L ↓ v₁' ↦ v₂`, and `γ ⊢ M ↓ v₁'`.
      We have `γ ⊢ L ↓ v₁' ↦ (v₁ ⊔ v₂)` by rule `sub`
      because `v₁' ↦ (v₁ ⊔ v₂) ⊑ v₁' ↦ v₂`.
    * Suppose `γ ⊢ L ↓ v₁' ↦ v₁`, `γ ⊢ M ↓ v₁'`, and `v₂ ⊑ ⊥`.
      We have `γ ⊢ L ↓ v₁' ↦ (v₁ ⊔ v₂)` by rule `sub`
      because `v₁' ↦ (v₁ ⊔ v₂) ⊑ v₁' ↦ v₁`.
    * Suppose `γ ⊢ L ↓ v₁'' ↦ v₁, γ ⊢ M ↓ v₁''`,
      `γ ⊢ L ↓ v₁' ↦ v₂`, and `γ ⊢ M ↓ v₁'`.
      This case is the most interesting.
      By two uses of the rule `⊔-intro` we have
      `γ ⊢ L ↓ (v₁' ↦ v₂) ⊔ (v₁'' ↦ v₁)` and
      `γ ⊢ M ↓ (v₁' ⊔ v₁'')`. But this does not yet match
      what we need for `ℰ L ● ℰ M` because the result of
      `L` must be an `↦` whose input entry is `v₁' ⊔ v₁''`.
      So we use the `sub` rule to obtain 
      `γ ⊢ L ↓ (v₁' ⊔ v₁'') ↦ (v₁ ⊔ v₂)`,
      using the `Dist⊔→⊔` lemma (thanks to the `Dist⊑` rule) to
      show that
   
            (v₁' ⊔ v₁'') ↦ (v₁ ⊔ v₂) ⊑ (v₁' ↦ v₂) ⊔ (v₁'' ↦ v₁)
   
      So we have proved what is needed for this case.

* In case `sub` we have `Γ ⊢ L · M ↓ v₁` and `v ⊑ v₁`.
  By the induction hypothesis, we have `(ℰ L ● ℰ M) γ v₁`.
  We have two subcases to consider.

    * Suppose `v₁ ⊑ ⊥`. We conclude that `v ⊑ ⊥`.
    * Suppose `Γ ⊢ L ↓ v' → v₁` and `Γ ⊢ M ↓ v'`.
      We conclude with `Γ ⊢ L ↓ v' → v` by rule `sub`, because
      `v' → v ⊑ v' → v₁`. 


The foward direction is proved by cases on the premise `(ℰ L ● ℰ M) γ v`.
In case `v ⊑ ⊥`, we obtain `Γ ⊢ L · M ↓ ⊥` by rule `⊥-intro`.
Otherwise, we conclude immediately by rule `↦-elim`.

<pre class="Agda">{% raw %}<a id="●ℰ→ℰ·"></a><a id="8794" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8794" class="Function">●ℰ→ℰ·</a> <a id="8800" class="Symbol">:</a> <a id="8802" class="Symbol">∀{</a><a id="8804" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8804" class="Bound">Γ</a><a id="8805" class="Symbol">}{</a><a id="8807" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8807" class="Bound">γ</a> <a id="8809" class="Symbol">:</a> <a id="8811" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7331" class="Function">Env</a> <a id="8815" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8804" class="Bound">Γ</a><a id="8816" class="Symbol">}{</a><a id="8818" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8818" class="Bound">L</a> <a id="8820" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8820" class="Bound">M</a> <a id="8822" class="Symbol">:</a> <a id="8824" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8804" class="Bound">Γ</a> <a id="8826" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="8828" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="8829" class="Symbol">}{</a><a id="8831" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8831" class="Bound">v</a><a id="8832" class="Symbol">}</a>
      <a id="8840" class="Symbol">→</a> <a id="8842" class="Symbol">(</a><a id="8843" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="8845" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8818" class="Bound">L</a> <a id="8847" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5229" class="Function Operator">●</a> <a id="8849" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="8851" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8820" class="Bound">M</a><a id="8852" class="Symbol">)</a> <a id="8854" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8807" class="Bound">γ</a> <a id="8856" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8831" class="Bound">v</a>
        <a id="8866" class="Comment">----------------</a>
      <a id="8889" class="Symbol">→</a> <a id="8891" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="8893" class="Symbol">(</a><a id="8894" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8818" class="Bound">L</a> <a id="8896" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4298" class="InductiveConstructor Operator">·</a> <a id="8898" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8820" class="Bound">M</a><a id="8899" class="Symbol">)</a> <a id="8901" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8807" class="Bound">γ</a> <a id="8903" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8831" class="Bound">v</a>
<a id="8905" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8794" class="Function">●ℰ→ℰ·</a> <a id="8911" class="Symbol">{</a><a id="8912" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8912" class="Bound">γ</a><a id="8913" class="Symbol">}{</a><a id="8915" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8915" class="Bound">v</a><a id="8916" class="Symbol">}</a> <a id="8918" class="Symbol">(</a><a id="8919" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="8924" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8924" class="Bound">lt</a><a id="8926" class="Symbol">)</a> <a id="8928" class="Symbol">=</a> <a id="8930" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10462" class="InductiveConstructor">sub</a> <a id="8934" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10251" class="InductiveConstructor">⊥-intro</a> <a id="8942" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8924" class="Bound">lt</a>
<a id="8945" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8794" class="Function">●ℰ→ℰ·</a> <a id="8951" class="Symbol">{</a><a id="8952" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8952" class="Bound">γ</a><a id="8953" class="Symbol">}{</a><a id="8955" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8955" class="Bound">v</a><a id="8956" class="Symbol">}</a> <a id="8958" class="Symbol">(</a><a id="8959" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="8964" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="8966" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8966" class="Bound">v₁</a> <a id="8969" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="8971" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="8973" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8973" class="Bound">d1</a> <a id="8976" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="8978" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8978" class="Bound">d2</a> <a id="8981" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="8983" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a><a id="8984" class="Symbol">)</a> <a id="8986" class="Symbol">=</a> <a id="8988" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9989" class="InductiveConstructor">↦-elim</a> <a id="8995" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8973" class="Bound">d1</a> <a id="8998" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8978" class="Bound">d2</a>{% endraw %}</pre>

So we have proved that the semantics is compositional with respect to
function application, as witnessed by the `●` function.

<pre class="Agda">{% raw %}<a id="app-equiv"></a><a id="9153" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9153" class="Function">app-equiv</a> <a id="9163" class="Symbol">:</a> <a id="9165" class="Symbol">∀{</a><a id="9167" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9167" class="Bound">Γ</a><a id="9168" class="Symbol">}{</a><a id="9170" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9170" class="Bound">γ</a> <a id="9172" class="Symbol">:</a> <a id="9174" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7331" class="Function">Env</a> <a id="9178" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9167" class="Bound">Γ</a><a id="9179" class="Symbol">}{</a><a id="9181" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9181" class="Bound">L</a> <a id="9183" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9183" class="Bound">M</a> <a id="9185" class="Symbol">:</a> <a id="9187" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9167" class="Bound">Γ</a> <a id="9189" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="9191" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="9192" class="Symbol">}</a>
          <a id="9204" class="Symbol">→</a> <a id="9206" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="9208" class="Symbol">(</a><a id="9209" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9181" class="Bound">L</a> <a id="9211" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4298" class="InductiveConstructor Operator">·</a> <a id="9213" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9183" class="Bound">M</a><a id="9214" class="Symbol">)</a> <a id="9216" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18532" class="Function Operator">≃</a> <a id="9218" class="Symbol">(</a><a id="9219" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="9221" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9181" class="Bound">L</a><a id="9222" class="Symbol">)</a> <a id="9224" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5229" class="Function Operator">●</a> <a id="9226" class="Symbol">(</a><a id="9227" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="9229" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9183" class="Bound">M</a><a id="9230" class="Symbol">)</a>
<a id="9232" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9153" class="Function">app-equiv</a> <a id="9242" class="Symbol">=</a> <a id="9244" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="9246" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#5537" class="Function">ℰ·→●ℰ</a> <a id="9252" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="9254" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#8794" class="Function">●ℰ→ℰ·</a> <a id="9260" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>{% endraw %}</pre>

We also need an inversion lemma for variables.
If `Γ ⊢ x ↓ v`, then `v ⊑ nth x γ`. The proof is a straightforward
induction on the semantics.

<pre class="Agda">{% raw %}<a id="var-inv"></a><a id="9430" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9430" class="Function">var-inv</a> <a id="9438" class="Symbol">:</a> <a id="9440" class="Symbol">∀</a> <a id="9442" class="Symbol">{</a><a id="9443" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9443" class="Bound">Γ</a> <a id="9445" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9445" class="Bound">v</a> <a id="9447" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9447" class="Bound">x</a><a id="9448" class="Symbol">}</a> <a id="9450" class="Symbol">{</a><a id="9451" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9451" class="Bound">γ</a> <a id="9453" class="Symbol">:</a> <a id="9455" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7331" class="Function">Env</a> <a id="9459" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9443" class="Bound">Γ</a><a id="9460" class="Symbol">}</a>
  <a id="9464" class="Symbol">→</a> <a id="9466" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="9468" class="Symbol">(</a><a id="9469" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4186" class="InductiveConstructor Operator">`</a> <a id="9471" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9447" class="Bound">x</a><a id="9472" class="Symbol">)</a> <a id="9474" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9451" class="Bound">γ</a> <a id="9476" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9445" class="Bound">v</a>
    <a id="9482" class="Comment">-------------------</a>
  <a id="9504" class="Symbol">→</a> <a id="9506" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9445" class="Bound">v</a> <a id="9508" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4468" class="Datatype Operator">⊑</a> <a id="9510" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9451" class="Bound">γ</a> <a id="9512" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9447" class="Bound">x</a>
<a id="9514" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9430" class="Function">var-inv</a> <a id="9522" class="Symbol">(</a><a id="9523" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9910" class="InductiveConstructor">var</a><a id="9526" class="Symbol">)</a> <a id="9528" class="Symbol">=</a> <a id="9530" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#5638" class="Function">Refl⊑</a>
<a id="9536" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9430" class="Function">var-inv</a> <a id="9544" class="Symbol">(</a><a id="9545" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10326" class="InductiveConstructor">⊔-intro</a> <a id="9553" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9553" class="Bound">d₁</a> <a id="9556" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9556" class="Bound">d₂</a><a id="9558" class="Symbol">)</a> <a id="9560" class="Symbol">=</a> <a id="9562" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4527" class="InductiveConstructor">ConjL⊑</a> <a id="9569" class="Symbol">(</a><a id="9570" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9430" class="Function">var-inv</a> <a id="9578" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9553" class="Bound">d₁</a><a id="9580" class="Symbol">)</a> <a id="9582" class="Symbol">(</a><a id="9583" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9430" class="Function">var-inv</a> <a id="9591" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9556" class="Bound">d₂</a><a id="9593" class="Symbol">)</a>
<a id="9595" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9430" class="Function">var-inv</a> <a id="9603" class="Symbol">(</a><a id="9604" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10462" class="InductiveConstructor">sub</a> <a id="9608" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9608" class="Bound">d</a> <a id="9610" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9610" class="Bound">lt</a><a id="9612" class="Symbol">)</a> <a id="9614" class="Symbol">=</a> <a id="9616" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4765" class="InductiveConstructor">Trans⊑</a> <a id="9623" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9610" class="Bound">lt</a> <a id="9626" class="Symbol">(</a><a id="9627" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9430" class="Function">var-inv</a> <a id="9635" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9608" class="Bound">d</a><a id="9636" class="Symbol">)</a>
<a id="9638" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9430" class="Function">var-inv</a> <a id="9646" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10251" class="InductiveConstructor">⊥-intro</a> <a id="9654" class="Symbol">=</a> <a id="9656" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4503" class="InductiveConstructor">Bot⊑</a>{% endraw %}</pre>

To round-out the semantic equations, we establish the following one
for variables.

<pre class="Agda">{% raw %}<a id="var-equiv"></a><a id="9770" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9770" class="Function">var-equiv</a> <a id="9780" class="Symbol">:</a> <a id="9782" class="Symbol">∀{</a><a id="9784" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9784" class="Bound">Γ</a><a id="9785" class="Symbol">}{</a><a id="9787" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9787" class="Bound">γ</a> <a id="9789" class="Symbol">:</a> <a id="9791" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7331" class="Function">Env</a> <a id="9795" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9784" class="Bound">Γ</a><a id="9796" class="Symbol">}{</a><a id="9798" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9798" class="Bound">x</a> <a id="9800" class="Symbol">:</a> <a id="9802" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9784" class="Bound">Γ</a> <a id="9804" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3365" class="Datatype Operator">∋</a> <a id="9806" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="9807" class="Symbol">}</a>
          <a id="9819" class="Symbol">→</a> <a id="9821" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18334" class="Function">ℰ</a> <a id="9823" class="Symbol">(</a><a id="9824" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4186" class="InductiveConstructor Operator">`</a> <a id="9826" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9798" class="Bound">x</a><a id="9827" class="Symbol">)</a> <a id="9829" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18532" class="Function Operator">≃</a> <a id="9831" class="Symbol">(λ</a> <a id="9834" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9834" class="Bound">γ</a> <a id="9836" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9836" class="Bound">v</a> <a id="9838" class="Symbol">→</a> <a id="9840" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9836" class="Bound">v</a> <a id="9842" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4468" class="Datatype Operator">⊑</a> <a id="9844" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8180" class="Function">nth</a> <a id="9848" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9798" class="Bound">x</a> <a id="9850" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9834" class="Bound">γ</a><a id="9851" class="Symbol">)</a>
<a id="9853" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9770" class="Function">var-equiv</a> <a id="9863" class="Symbol">=</a> <a id="9865" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="9867" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9430" class="Function">var-inv</a> <a id="9875" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="9877" class="Symbol">(λ</a> <a id="9880" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9880" class="Bound">lt</a> <a id="9883" class="Symbol">→</a> <a id="9885" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10462" class="InductiveConstructor">sub</a> <a id="9889" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9910" class="InductiveConstructor">var</a> <a id="9893" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9880" class="Bound">lt</a><a id="9895" class="Symbol">)</a> <a id="9897" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>{% endraw %}</pre>
