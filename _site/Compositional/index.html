<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Compositional: The denotational semantics is compositional | Programming Language Foundations in Agda
</title><!-- Begin Jekyll SEO tag v2.5.0 -->
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Compositional: The denotational semantics is compositional" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Programming Language Foundations in Agda" />
<meta property="og:description" content="Programming Language Foundations in Agda" />
<link rel="canonical" href="https://plfa.github.io/Compositional/" />
<meta property="og:url" content="https://plfa.github.io/Compositional/" />
<meta property="og:site_name" content="Programming Language Foundations in Agda" />
<script type="application/ld+json">
{"description":"Programming Language Foundations in Agda","@type":"WebPage","url":"https://plfa.github.io/Compositional/","headline":"Compositional: The denotational semantics is compositional","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"></head>
<body><header class="site-header" role="banner">

    <div class="wrapper">

        <a class="site-title" href="/">Programming Language Foundations in Agda
</a>

        <nav class="site-nav">
            <span class="menu-icon">
                <svg viewBox="0 0 18 15" width="18px" height="15px">
                    <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
                    <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
                    <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
                </svg>
            </span>

            <div class="trigger">
                <a class="page-link" href="/">Table of Contents</a>
                <a class="page-link" href="/GettingStarted/">Getting Started</a>
            </div>
        </nav>

    </div>

</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
      <h1 class="post-title">Compositional: The denotational semantics is compositional</h1>
  </header>

  <p style="text-align:center;">
    
    <a alt="Previous chapter" href="/Denotational/">Prev</a>
    &bullet;
    
    
    <a alt="Source code" href="https://github.com/plfa/plfa.github.io/blob/dev/src/plfa/Compositional.lagda">Source</a>
    
    
    &bullet;
    <a alt="Next chapter" href="/Soundness/">Next</a>
    
</p>


  <div class="post-content">
    <pre class="Agda"><a id="192" class="Keyword">module</a> <a id="199" href="/Compositional/" class="Module">plfa.Compositional</a> <a id="218" class="Keyword">where</a></pre>

<h2 id="imports">Imports</h2>

<pre class="Agda"><a id="261" class="Keyword">open</a> <a id="266" class="Keyword">import</a> <a id="273" href="/Untyped/" class="Module">plfa.Untyped</a>
<a id="286" class="Keyword">open</a> <a id="291" class="Keyword">import</a> <a id="298" href="/Denotational/" class="Module">plfa.Denotational</a>

<a id="317" class="Keyword">open</a> <a id="322" class="Keyword">import</a> <a id="329" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
  <a id="369" class="Keyword">using</a> <a id="375" class="Symbol">(</a><a id="376" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a><a id="379" class="Symbol">;</a> <a id="381" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.Core.html#660" class="Function Operator">_≢_</a><a id="384" class="Symbol">;</a> <a id="386" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="390" class="Symbol">;</a> <a id="392" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a><a id="395" class="Symbol">;</a> <a id="397" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a><a id="401" class="Symbol">;</a> <a id="403" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a><a id="408" class="Symbol">;</a> <a id="410" href="https://agda.github.io/agda-stdlib/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a><a id="418" class="Symbol">)</a>
<a id="420" class="Keyword">open</a> <a id="425" class="Keyword">import</a> <a id="432" href="https://agda.github.io/agda-stdlib/Data.Product.html" class="Module">Data.Product</a> <a id="445" class="Keyword">using</a> <a id="451" class="Symbol">(</a><a id="452" href="https://agda.github.io/agda-stdlib/Data.Product.html#1353" class="Function Operator">_×_</a><a id="455" class="Symbol">;</a> <a id="457" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#69" class="Record">Σ</a><a id="458" class="Symbol">;</a> <a id="460" href="https://agda.github.io/agda-stdlib/Data.Product.html#764" class="Function">Σ-syntax</a><a id="468" class="Symbol">;</a> <a id="470" href="https://agda.github.io/agda-stdlib/Data.Product.html#881" class="Function">∃</a><a id="471" class="Symbol">;</a> <a id="473" href="https://agda.github.io/agda-stdlib/Data.Product.html#942" class="Function">∃-syntax</a><a id="481" class="Symbol">;</a> <a id="483" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#155" class="Field">proj₁</a><a id="488" class="Symbol">;</a> <a id="490" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#167" class="Field">proj₂</a><a id="495" class="Symbol">)</a>
  <a id="499" class="Keyword">renaming</a> <a id="508" class="Symbol">(</a><a id="509" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">_,_</a> <a id="513" class="Symbol">to</a> <a id="516" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨_,_⟩</a><a id="521" class="Symbol">)</a>
<a id="523" class="Keyword">open</a> <a id="528" class="Keyword">import</a> <a id="535" href="https://agda.github.io/agda-stdlib/Data.Sum.html" class="Module">Data.Sum</a>
<a id="544" class="Keyword">open</a> <a id="549" class="Keyword">import</a> <a id="556" href="https://agda.github.io/agda-stdlib/Agda.Primitive.html" class="Module">Agda.Primitive</a> <a id="571" class="Keyword">using</a> <a id="577" class="Symbol">(</a><a id="578" href="https://agda.github.io/agda-stdlib/Agda.Primitive.html#611" class="Primitive">lzero</a><a id="583" class="Symbol">)</a>
<a id="585" class="Keyword">open</a> <a id="590" class="Keyword">import</a> <a id="597" href="https://agda.github.io/agda-stdlib/Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="614" class="Keyword">using</a> <a id="620" class="Symbol">(</a><a id="621" href="https://agda.github.io/agda-stdlib/Relation.Nullary.html#464" class="Function Operator">¬_</a><a id="623" class="Symbol">)</a>
<a id="625" class="Keyword">open</a> <a id="630" class="Keyword">import</a> <a id="637" href="https://agda.github.io/agda-stdlib/Relation.Nullary.Negation.html" class="Module">Relation.Nullary.Negation</a> <a id="663" class="Keyword">using</a> <a id="669" class="Symbol">(</a><a id="670" href="https://agda.github.io/agda-stdlib/Relation.Nullary.Negation.html#560" class="Function">contradiction</a><a id="683" class="Symbol">)</a>
<a id="685" class="Keyword">open</a> <a id="690" class="Keyword">import</a> <a id="697" href="https://agda.github.io/agda-stdlib/Data.Empty.html" class="Module">Data.Empty</a> <a id="708" class="Keyword">using</a> <a id="714" class="Symbol">(</a><a id="715" href="https://agda.github.io/agda-stdlib/Data.Empty.html#360" class="Function">⊥-elim</a><a id="721" class="Symbol">)</a>
<a id="723" class="Keyword">open</a> <a id="728" class="Keyword">import</a> <a id="735" href="https://agda.github.io/agda-stdlib/Data.Unit.html" class="Module">Data.Unit</a>
<a id="745" class="Keyword">open</a> <a id="750" class="Keyword">import</a> <a id="757" href="https://agda.github.io/agda-stdlib/Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="774" class="Keyword">using</a> <a id="780" class="Symbol">(</a><a id="781" href="https://agda.github.io/agda-stdlib/Relation.Nullary.html#534" class="Datatype">Dec</a><a id="784" class="Symbol">;</a> <a id="786" href="https://agda.github.io/agda-stdlib/Relation.Nullary.html#570" class="InductiveConstructor">yes</a><a id="789" class="Symbol">;</a> <a id="791" href="https://agda.github.io/agda-stdlib/Relation.Nullary.html#597" class="InductiveConstructor">no</a><a id="793" class="Symbol">)</a>
<a id="795" class="Keyword">open</a> <a id="800" class="Keyword">import</a> <a id="807" href="https://agda.github.io/agda-stdlib/Function.html" class="Module">Function</a> <a id="816" class="Keyword">using</a> <a id="822" class="Symbol">(</a><a id="823" href="https://agda.github.io/agda-stdlib/Function.html#769" class="Function Operator">_∘_</a><a id="826" class="Symbol">)</a>
<a id="828" class="Comment">-- open import plfa.Isomorphism using (extensionality)  -- causes a bug!</a></pre>

<h2 id="compositionality">Compositionality</h2>

<p>To prove that the denotational semantics is compositional, we need to
fill in the ellipses in the following equations.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ℰ (ƛ M) ≃ ... ℰ M ...
ℰ (M · N) ≃ ... ℰ M ... ℰ N ...
</code></pre></div></div>

<p>Regarding the first equation, we need a function that maps a
<code class="highlighter-rouge">Denotation (Γ , ★)</code> to a <code class="highlighter-rouge">Denotation Γ</code>. This function, let us name it <code class="highlighter-rouge">ℱ</code>,
should mimic the non-recursive part of the semantics when applied to a
lambda term.  In particular, we need to consider the rules <code class="highlighter-rouge">↦-intro</code>,
<code class="highlighter-rouge">⊥-intro</code>, and <code class="highlighter-rouge">⊔-intro</code>. So <code class="highlighter-rouge">ℱ</code> has three parameters, the denotation <code class="highlighter-rouge">D</code>
of the subterm <code class="highlighter-rouge">M</code>, an environment <code class="highlighter-rouge">γ</code>, and a value <code class="highlighter-rouge">v</code>.  If we define <code class="highlighter-rouge">ℱ</code> by
recursion on the value <code class="highlighter-rouge">v</code>, then it matches up nicely with the three
rules <code class="highlighter-rouge">↦-intro</code>, <code class="highlighter-rouge">⊥-intro</code>, and <code class="highlighter-rouge">⊔-intro</code>.</p>

<pre class="Agda"><a id="ℱ"></a><a id="1674" href="/Compositional/#1674" class="Function">ℱ</a> <a id="1676" class="Symbol">:</a> <a id="1678" class="Symbol">∀{</a><a id="1680" href="/Compositional/#1680" class="Bound">Γ</a><a id="1681" class="Symbol">}</a> <a id="1683" class="Symbol">→</a> <a id="1685" href="/Denotational/#18105" class="Function">Denotation</a> <a id="1696" class="Symbol">(</a><a id="1697" href="/Compositional/#1680" class="Bound">Γ</a> <a id="1699" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="1701" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="1702" class="Symbol">)</a> <a id="1704" class="Symbol">→</a> <a id="1706" href="/Denotational/#18105" class="Function">Denotation</a> <a id="1717" href="/Compositional/#1680" class="Bound">Γ</a>
<a id="1719" href="/Compositional/#1674" class="Function">ℱ</a> <a id="1721" href="/Compositional/#1721" class="Bound">D</a> <a id="1723" href="/Compositional/#1723" class="Bound">γ</a> <a id="1725" class="Symbol">(</a><a id="1726" href="/Compositional/#1726" class="Bound">v₁</a> <a id="1729" href="/Denotational/#4129" class="InductiveConstructor Operator">↦</a> <a id="1731" href="/Compositional/#1731" class="Bound">v₂</a><a id="1733" class="Symbol">)</a> <a id="1735" class="Symbol">=</a> <a id="1737" href="/Compositional/#1721" class="Bound">D</a> <a id="1739" class="Symbol">(</a><a id="1740" href="/Compositional/#1723" class="Bound">γ</a> <a id="1742" href="/Denotational/#7489" class="Function Operator">`,</a> <a id="1745" href="/Compositional/#1726" class="Bound">v₁</a><a id="1747" class="Symbol">)</a> <a id="1749" href="/Compositional/#1731" class="Bound">v₂</a>
<a id="1752" href="/Compositional/#1674" class="Function">ℱ</a> <a id="1754" href="/Compositional/#1754" class="Bound">D</a> <a id="1756" href="/Compositional/#1756" class="Bound">γ</a> <a id="1758" href="/Denotational/#4117" class="InductiveConstructor">⊥</a> <a id="1760" class="Symbol">=</a> <a id="1762" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Unit.html#69" class="Record">⊤</a>
<a id="1764" href="/Compositional/#1674" class="Function">ℱ</a> <a id="1766" href="/Compositional/#1766" class="Bound">D</a> <a id="1768" href="/Compositional/#1768" class="Bound">γ</a> <a id="1770" class="Symbol">(</a><a id="1771" href="/Compositional/#1771" class="Bound">v₁</a> <a id="1774" href="/Denotational/#4159" class="InductiveConstructor Operator">⊔</a> <a id="1776" href="/Compositional/#1776" class="Bound">v₂</a><a id="1778" class="Symbol">)</a> <a id="1780" class="Symbol">=</a> <a id="1782" class="Symbol">(</a><a id="1783" href="/Compositional/#1674" class="Function">ℱ</a> <a id="1785" href="/Compositional/#1766" class="Bound">D</a> <a id="1787" href="/Compositional/#1768" class="Bound">γ</a> <a id="1789" href="/Compositional/#1771" class="Bound">v₁</a><a id="1791" class="Symbol">)</a> <a id="1793" href="https://agda.github.io/agda-stdlib/Data.Product.html#1353" class="Function Operator">×</a> <a id="1795" class="Symbol">(</a><a id="1796" href="/Compositional/#1674" class="Function">ℱ</a> <a id="1798" href="/Compositional/#1766" class="Bound">D</a> <a id="1800" href="/Compositional/#1768" class="Bound">γ</a> <a id="1802" href="/Compositional/#1776" class="Bound">v₂</a><a id="1804" class="Symbol">)</a></pre>

<p>Using this <code class="highlighter-rouge">ℱ</code>, we hope to prove that</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ℰ (ƛ M) ≃ ℱ (ℰ M)
</code></pre></div></div>

<p>The function <code class="highlighter-rouge">ℱ</code> is preserved when going from a larger value <code class="highlighter-rouge">v</code> to a
smaller value <code class="highlighter-rouge">u</code>. The proof is a straightforward induction on the
derivation of <code class="highlighter-rouge">u ⊑ v</code>, using the <code class="highlighter-rouge">up-env</code> lemma in the case for the
<code class="highlighter-rouge">Fun⊑</code> rule.</p>

<pre class="Agda"><a id="sub-ℱ"></a><a id="2112" href="/Compositional/#2112" class="Function">sub-ℱ</a> <a id="2118" class="Symbol">:</a> <a id="2120" class="Symbol">∀{</a><a id="2122" href="/Compositional/#2122" class="Bound">Γ</a><a id="2123" class="Symbol">}{</a><a id="2125" href="/Compositional/#2125" class="Bound">M</a> <a id="2127" class="Symbol">:</a> <a id="2129" href="/Compositional/#2122" class="Bound">Γ</a> <a id="2131" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="2133" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="2135" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="2137" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="2138" class="Symbol">}{</a><a id="2140" href="/Compositional/#2140" class="Bound">γ</a> <a id="2142" href="/Compositional/#2142" class="Bound">v</a> <a id="2144" href="/Compositional/#2144" class="Bound">u</a><a id="2145" class="Symbol">}</a>
      <a id="2153" class="Symbol">→</a> <a id="2155" href="/Compositional/#1674" class="Function">ℱ</a> <a id="2157" class="Symbol">(</a><a id="2158" href="/Denotational/#18334" class="Function">ℰ</a> <a id="2160" href="/Compositional/#2125" class="Bound">M</a><a id="2161" class="Symbol">)</a> <a id="2163" href="/Compositional/#2140" class="Bound">γ</a> <a id="2165" href="/Compositional/#2142" class="Bound">v</a>
      <a id="2173" class="Symbol">→</a> <a id="2175" href="/Compositional/#2144" class="Bound">u</a> <a id="2177" href="/Denotational/#4468" class="Datatype Operator">⊑</a> <a id="2179" href="/Compositional/#2142" class="Bound">v</a>
        <a id="2189" class="Comment">------------</a>
      <a id="2208" class="Symbol">→</a> <a id="2210" href="/Compositional/#1674" class="Function">ℱ</a> <a id="2212" class="Symbol">(</a><a id="2213" href="/Denotational/#18334" class="Function">ℰ</a> <a id="2215" href="/Compositional/#2125" class="Bound">M</a><a id="2216" class="Symbol">)</a> <a id="2218" href="/Compositional/#2140" class="Bound">γ</a> <a id="2220" href="/Compositional/#2144" class="Bound">u</a>
<a id="2222" href="/Compositional/#2112" class="Function">sub-ℱ</a> <a id="2228" href="/Compositional/#2228" class="Bound">d</a> <a id="2230" href="/Denotational/#4503" class="InductiveConstructor">Bot⊑</a> <a id="2235" class="Symbol">=</a> <a id="2237" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Unit.html#106" class="InductiveConstructor">tt</a>
<a id="2240" href="/Compositional/#2112" class="Function">sub-ℱ</a> <a id="2246" href="/Compositional/#2246" class="Bound">d</a> <a id="2248" class="Symbol">(</a><a id="2249" href="/Denotational/#4839" class="InductiveConstructor">Fun⊑</a> <a id="2254" href="/Compositional/#2254" class="Bound">lt</a> <a id="2257" href="/Compositional/#2257" class="Bound">lt&#39;</a><a id="2260" class="Symbol">)</a> <a id="2262" class="Symbol">=</a> <a id="2264" href="/Denotational/#10462" class="InductiveConstructor">sub</a> <a id="2268" class="Symbol">(</a><a id="2269" href="/Denotational/#26641" class="Function">up-env</a> <a id="2276" href="/Compositional/#2246" class="Bound">d</a> <a id="2278" href="/Compositional/#2254" class="Bound">lt</a><a id="2280" class="Symbol">)</a> <a id="2282" href="/Compositional/#2257" class="Bound">lt&#39;</a>
<a id="2286" href="/Compositional/#2112" class="Function">sub-ℱ</a> <a id="2292" href="/Compositional/#2292" class="Bound">d</a> <a id="2294" class="Symbol">(</a><a id="2295" href="/Denotational/#4527" class="InductiveConstructor">ConjL⊑</a> <a id="2302" href="/Compositional/#2302" class="Bound">lt</a> <a id="2305" href="/Compositional/#2305" class="Bound">lt₁</a><a id="2308" class="Symbol">)</a> <a id="2310" class="Symbol">=</a> <a id="2312" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="2314" href="/Compositional/#2112" class="Function">sub-ℱ</a> <a id="2320" href="/Compositional/#2292" class="Bound">d</a> <a id="2322" href="/Compositional/#2302" class="Bound">lt</a> <a id="2325" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2327" href="/Compositional/#2112" class="Function">sub-ℱ</a> <a id="2333" href="/Compositional/#2292" class="Bound">d</a> <a id="2335" href="/Compositional/#2305" class="Bound">lt₁</a> <a id="2339" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>
<a id="2341" href="/Compositional/#2112" class="Function">sub-ℱ</a> <a id="2347" href="/Compositional/#2347" class="Bound">d</a> <a id="2349" class="Symbol">(</a><a id="2350" href="/Denotational/#4617" class="InductiveConstructor">ConjR1⊑</a> <a id="2358" href="/Compositional/#2358" class="Bound">lt</a><a id="2360" class="Symbol">)</a> <a id="2362" class="Symbol">=</a> <a id="2364" href="/Compositional/#2112" class="Function">sub-ℱ</a> <a id="2370" class="Symbol">(</a><a id="2371" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#155" class="Field">proj₁</a> <a id="2377" href="/Compositional/#2347" class="Bound">d</a><a id="2378" class="Symbol">)</a> <a id="2380" href="/Compositional/#2358" class="Bound">lt</a>
<a id="2383" href="/Compositional/#2112" class="Function">sub-ℱ</a> <a id="2389" href="/Compositional/#2389" class="Bound">d</a> <a id="2391" class="Symbol">(</a><a id="2392" href="/Denotational/#4691" class="InductiveConstructor">ConjR2⊑</a> <a id="2400" href="/Compositional/#2400" class="Bound">lt</a><a id="2402" class="Symbol">)</a> <a id="2404" class="Symbol">=</a> <a id="2406" href="/Compositional/#2112" class="Function">sub-ℱ</a> <a id="2412" class="Symbol">(</a><a id="2413" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#167" class="Field">proj₂</a> <a id="2419" href="/Compositional/#2389" class="Bound">d</a><a id="2420" class="Symbol">)</a> <a id="2422" href="/Compositional/#2400" class="Bound">lt</a>
<a id="2425" href="/Compositional/#2112" class="Function">sub-ℱ</a> <a id="2431" class="Symbol">{</a><a id="2432" class="Argument">v</a> <a id="2434" class="Symbol">=</a> <a id="2436" href="/Compositional/#2436" class="Bound">v₁</a> <a id="2439" href="/Denotational/#4129" class="InductiveConstructor Operator">↦</a> <a id="2441" href="/Compositional/#2441" class="Bound">v₂</a> <a id="2444" href="/Denotational/#4159" class="InductiveConstructor Operator">⊔</a> <a id="2446" href="/Compositional/#2436" class="Bound">v₁</a> <a id="2449" href="/Denotational/#4129" class="InductiveConstructor Operator">↦</a> <a id="2451" href="/Compositional/#2451" class="Bound">v₃</a><a id="2453" class="Symbol">}</a> <a id="2455" class="Symbol">{</a><a id="2456" href="/Compositional/#2436" class="Bound">v₁</a> <a id="2459" href="/Denotational/#4129" class="InductiveConstructor Operator">↦</a> <a id="2461" class="Symbol">(</a><a id="2462" href="/Compositional/#2441" class="Bound">v₂</a> <a id="2465" href="/Denotational/#4159" class="InductiveConstructor Operator">⊔</a> <a id="2467" href="/Compositional/#2451" class="Bound">v₃</a><a id="2469" class="Symbol">)}</a> <a id="2472" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="2474" href="/Compositional/#2474" class="Bound">M2</a> <a id="2477" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2479" href="/Compositional/#2479" class="Bound">M3</a> <a id="2482" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="2484" href="/Denotational/#4953" class="InductiveConstructor">Dist⊑</a> <a id="2490" class="Symbol">=</a>
   <a id="2495" href="/Denotational/#10326" class="InductiveConstructor">⊔-intro</a> <a id="2503" href="/Compositional/#2474" class="Bound">M2</a> <a id="2506" href="/Compositional/#2479" class="Bound">M3</a>
<a id="2509" href="/Compositional/#2112" class="Function">sub-ℱ</a> <a id="2515" href="/Compositional/#2515" class="Bound">d</a> <a id="2517" class="Symbol">(</a><a id="2518" href="/Denotational/#4765" class="InductiveConstructor">Trans⊑</a> <a id="2525" href="/Compositional/#2525" class="Bound">x₁</a> <a id="2528" href="/Compositional/#2528" class="Bound">x₂</a><a id="2530" class="Symbol">)</a> <a id="2532" class="Symbol">=</a> <a id="2534" href="/Compositional/#2112" class="Function">sub-ℱ</a> <a id="2540" class="Symbol">(</a><a id="2541" href="/Compositional/#2112" class="Function">sub-ℱ</a> <a id="2547" href="/Compositional/#2515" class="Bound">d</a> <a id="2549" href="/Compositional/#2528" class="Bound">x₂</a><a id="2551" class="Symbol">)</a> <a id="2553" href="/Compositional/#2525" class="Bound">x₁</a></pre>

<p>[PLW:
  If denotations were strengthened to be downward closed,
  we could rewrite the signature replacing (ℰ M) by d : Denotation (Γ , ★)]</p>

<p>With this subsumption property in hand, we can prove the forward
direction of the semantic equation for lambda.  The proof is by
induction on the semantics, using <code class="highlighter-rouge">sub-ℱ</code> in the case for the <code class="highlighter-rouge">sub</code>
rule.</p>

<pre class="Agda"><a id="ℰƛ→ℱℰ"></a><a id="2928" href="/Compositional/#2928" class="Function">ℰƛ→ℱℰ</a> <a id="2934" class="Symbol">:</a> <a id="2936" class="Symbol">∀{</a><a id="2938" href="/Compositional/#2938" class="Bound">Γ</a><a id="2939" class="Symbol">}{</a><a id="2941" href="/Compositional/#2941" class="Bound">γ</a> <a id="2943" class="Symbol">:</a> <a id="2945" href="/Denotational/#7331" class="Function">Env</a> <a id="2949" href="/Compositional/#2938" class="Bound">Γ</a><a id="2950" class="Symbol">}{</a><a id="2952" href="/Compositional/#2952" class="Bound">M</a> <a id="2954" class="Symbol">:</a> <a id="2956" href="/Compositional/#2938" class="Bound">Γ</a> <a id="2958" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="2960" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="2962" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="2964" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="2965" class="Symbol">}{</a><a id="2967" href="/Compositional/#2967" class="Bound">v</a> <a id="2969" class="Symbol">:</a> <a id="2971" href="/Denotational/#4097" class="Datatype">Value</a><a id="2976" class="Symbol">}</a>
        <a id="2986" class="Symbol">→</a> <a id="2988" href="/Denotational/#18334" class="Function">ℰ</a> <a id="2990" class="Symbol">(</a><a id="2991" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="2993" href="/Compositional/#2952" class="Bound">M</a><a id="2994" class="Symbol">)</a> <a id="2996" href="/Compositional/#2941" class="Bound">γ</a> <a id="2998" href="/Compositional/#2967" class="Bound">v</a>
          <a id="3010" class="Comment">------------</a>
        <a id="3031" class="Symbol">→</a> <a id="3033" href="/Compositional/#1674" class="Function">ℱ</a> <a id="3035" class="Symbol">(</a><a id="3036" href="/Denotational/#18334" class="Function">ℰ</a> <a id="3038" href="/Compositional/#2952" class="Bound">M</a><a id="3039" class="Symbol">)</a> <a id="3041" href="/Compositional/#2941" class="Bound">γ</a> <a id="3043" href="/Compositional/#2967" class="Bound">v</a>
<a id="3045" href="/Compositional/#2928" class="Function">ℰƛ→ℱℰ</a> <a id="3051" class="Symbol">(</a><a id="3052" href="/Denotational/#10127" class="InductiveConstructor">↦-intro</a> <a id="3060" href="/Compositional/#3060" class="Bound">d</a><a id="3061" class="Symbol">)</a> <a id="3063" class="Symbol">=</a> <a id="3065" href="/Compositional/#3060" class="Bound">d</a>
<a id="3067" href="/Compositional/#2928" class="Function">ℰƛ→ℱℰ</a> <a id="3073" href="/Denotational/#10251" class="InductiveConstructor">⊥-intro</a> <a id="3081" class="Symbol">=</a> <a id="3083" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Unit.html#106" class="InductiveConstructor">tt</a>
<a id="3086" href="/Compositional/#2928" class="Function">ℰƛ→ℱℰ</a> <a id="3092" class="Symbol">(</a><a id="3093" href="/Denotational/#10326" class="InductiveConstructor">⊔-intro</a> <a id="3101" href="/Compositional/#3101" class="Bound">d₁</a> <a id="3104" href="/Compositional/#3104" class="Bound">d₂</a><a id="3106" class="Symbol">)</a> <a id="3108" class="Symbol">=</a> <a id="3110" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="3112" href="/Compositional/#2928" class="Function">ℰƛ→ℱℰ</a> <a id="3118" href="/Compositional/#3101" class="Bound">d₁</a> <a id="3121" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3123" href="/Compositional/#2928" class="Function">ℰƛ→ℱℰ</a> <a id="3129" href="/Compositional/#3104" class="Bound">d₂</a> <a id="3132" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>
<a id="3134" href="/Compositional/#2928" class="Function">ℰƛ→ℱℰ</a> <a id="3140" class="Symbol">(</a><a id="3141" href="/Denotational/#10462" class="InductiveConstructor">sub</a> <a id="3145" href="/Compositional/#3145" class="Bound">d</a> <a id="3147" href="/Compositional/#3147" class="Bound">lt</a><a id="3149" class="Symbol">)</a> <a id="3151" class="Symbol">=</a> <a id="3153" href="/Compositional/#2112" class="Function">sub-ℱ</a> <a id="3159" class="Symbol">(</a><a id="3160" href="/Compositional/#2928" class="Function">ℰƛ→ℱℰ</a> <a id="3166" href="/Compositional/#3145" class="Bound">d</a><a id="3167" class="Symbol">)</a> <a id="3169" href="/Compositional/#3147" class="Bound">lt</a></pre>

<p>The “inversion lemma” for lambda abstraction is a special case of the
above. The inversion lemma is useful in proving that denotations are
preserved by reduction.</p>

<pre class="Agda"><a id="lambda-inversion"></a><a id="3361" href="/Compositional/#3361" class="Function">lambda-inversion</a> <a id="3378" class="Symbol">:</a> <a id="3380" class="Symbol">∀{</a><a id="3382" href="/Compositional/#3382" class="Bound">Γ</a><a id="3383" class="Symbol">}{</a><a id="3385" href="/Compositional/#3385" class="Bound">γ</a> <a id="3387" class="Symbol">:</a> <a id="3389" href="/Denotational/#7331" class="Function">Env</a> <a id="3393" href="/Compositional/#3382" class="Bound">Γ</a><a id="3394" class="Symbol">}{</a><a id="3396" href="/Compositional/#3396" class="Bound">M</a> <a id="3398" class="Symbol">:</a> <a id="3400" href="/Compositional/#3382" class="Bound">Γ</a> <a id="3402" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="3404" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="3406" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="3408" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="3409" class="Symbol">}{</a><a id="3411" href="/Compositional/#3411" class="Bound">v₁</a> <a id="3414" href="/Compositional/#3414" class="Bound">v₂</a> <a id="3417" class="Symbol">:</a> <a id="3419" href="/Denotational/#4097" class="Datatype">Value</a><a id="3424" class="Symbol">}</a>
  <a id="3428" class="Symbol">→</a> <a id="3430" href="/Compositional/#3385" class="Bound">γ</a> <a id="3432" href="/Denotational/#9856" class="Datatype Operator">⊢</a> <a id="3434" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="3436" href="/Compositional/#3396" class="Bound">M</a> <a id="3438" href="/Denotational/#9856" class="Datatype Operator">↓</a> <a id="3440" href="/Compositional/#3411" class="Bound">v₁</a> <a id="3443" href="/Denotational/#4129" class="InductiveConstructor Operator">↦</a> <a id="3445" href="/Compositional/#3414" class="Bound">v₂</a>
    <a id="3452" class="Comment">-----------------</a>
  <a id="3472" class="Symbol">→</a> <a id="3474" class="Symbol">(</a><a id="3475" href="/Compositional/#3385" class="Bound">γ</a> <a id="3477" href="/Denotational/#7489" class="Function Operator">`,</a> <a id="3480" href="/Compositional/#3411" class="Bound">v₁</a><a id="3482" class="Symbol">)</a> <a id="3484" href="/Denotational/#9856" class="Datatype Operator">⊢</a> <a id="3486" href="/Compositional/#3396" class="Bound">M</a> <a id="3488" href="/Denotational/#9856" class="Datatype Operator">↓</a> <a id="3490" href="/Compositional/#3414" class="Bound">v₂</a>
<a id="3493" href="/Compositional/#3361" class="Function">lambda-inversion</a><a id="3509" class="Symbol">{</a><a id="3510" class="Argument">v₁</a> <a id="3513" class="Symbol">=</a> <a id="3515" href="/Compositional/#3515" class="Bound">v₁</a><a id="3517" class="Symbol">}{</a><a id="3519" class="Argument">v₂</a> <a id="3522" class="Symbol">=</a> <a id="3524" href="/Compositional/#3524" class="Bound">v₂</a><a id="3526" class="Symbol">}</a> <a id="3528" href="/Compositional/#3528" class="Bound">d</a> <a id="3530" class="Symbol">=</a> <a id="3532" href="/Compositional/#2928" class="Function">ℰƛ→ℱℰ</a><a id="3537" class="Symbol">{</a><a id="3538" class="Argument">v</a> <a id="3540" class="Symbol">=</a> <a id="3542" href="/Compositional/#3515" class="Bound">v₁</a> <a id="3545" href="/Denotational/#4129" class="InductiveConstructor Operator">↦</a> <a id="3547" href="/Compositional/#3524" class="Bound">v₂</a><a id="3549" class="Symbol">}</a> <a id="3551" href="/Compositional/#3528" class="Bound">d</a></pre>

<p>The backward direction of the semantic equation for lambda is even
easier to prove than the forward direction. We proceed by induction on
the value v.</p>

<pre class="Agda"><a id="ℱℰ→ℰƛ"></a><a id="3730" href="/Compositional/#3730" class="Function">ℱℰ→ℰƛ</a> <a id="3736" class="Symbol">:</a> <a id="3738" class="Symbol">∀{</a><a id="3740" href="/Compositional/#3740" class="Bound">Γ</a><a id="3741" class="Symbol">}{</a><a id="3743" href="/Compositional/#3743" class="Bound">γ</a> <a id="3745" class="Symbol">:</a> <a id="3747" href="/Denotational/#7331" class="Function">Env</a> <a id="3751" href="/Compositional/#3740" class="Bound">Γ</a><a id="3752" class="Symbol">}{</a><a id="3754" href="/Compositional/#3754" class="Bound">M</a> <a id="3756" class="Symbol">:</a> <a id="3758" href="/Compositional/#3740" class="Bound">Γ</a> <a id="3760" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="3762" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="3764" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="3766" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="3767" class="Symbol">}{</a><a id="3769" href="/Compositional/#3769" class="Bound">v</a> <a id="3771" class="Symbol">:</a> <a id="3773" href="/Denotational/#4097" class="Datatype">Value</a><a id="3778" class="Symbol">}</a>
        <a id="3788" class="Symbol">→</a> <a id="3790" href="/Compositional/#1674" class="Function">ℱ</a> <a id="3792" class="Symbol">(</a><a id="3793" href="/Denotational/#18334" class="Function">ℰ</a> <a id="3795" href="/Compositional/#3754" class="Bound">M</a><a id="3796" class="Symbol">)</a> <a id="3798" href="/Compositional/#3743" class="Bound">γ</a> <a id="3800" href="/Compositional/#3769" class="Bound">v</a>
          <a id="3812" class="Comment">------------</a>
        <a id="3833" class="Symbol">→</a> <a id="3835" href="/Denotational/#18334" class="Function">ℰ</a> <a id="3837" class="Symbol">(</a><a id="3838" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="3840" href="/Compositional/#3754" class="Bound">M</a><a id="3841" class="Symbol">)</a> <a id="3843" href="/Compositional/#3743" class="Bound">γ</a> <a id="3845" href="/Compositional/#3769" class="Bound">v</a>
<a id="3847" href="/Compositional/#3730" class="Function">ℱℰ→ℰƛ</a> <a id="3853" class="Symbol">{</a><a id="3854" class="Argument">v</a> <a id="3856" class="Symbol">=</a> <a id="3858" href="/Denotational/#4117" class="InductiveConstructor">⊥</a><a id="3859" class="Symbol">}</a> <a id="3861" href="/Compositional/#3861" class="Bound">d</a> <a id="3863" class="Symbol">=</a> <a id="3865" href="/Denotational/#10251" class="InductiveConstructor">⊥-intro</a>
<a id="3873" href="/Compositional/#3730" class="Function">ℱℰ→ℰƛ</a> <a id="3879" class="Symbol">{</a><a id="3880" class="Argument">v</a> <a id="3882" class="Symbol">=</a> <a id="3884" href="/Compositional/#3884" class="Bound">v₁</a> <a id="3887" href="/Denotational/#4129" class="InductiveConstructor Operator">↦</a> <a id="3889" href="/Compositional/#3889" class="Bound">v₂</a><a id="3891" class="Symbol">}</a> <a id="3893" href="/Compositional/#3893" class="Bound">d</a> <a id="3895" class="Symbol">=</a> <a id="3897" href="/Denotational/#10127" class="InductiveConstructor">↦-intro</a> <a id="3905" href="/Compositional/#3893" class="Bound">d</a>
<a id="3907" href="/Compositional/#3730" class="Function">ℱℰ→ℰƛ</a> <a id="3913" class="Symbol">{</a><a id="3914" class="Argument">v</a> <a id="3916" class="Symbol">=</a> <a id="3918" href="/Compositional/#3918" class="Bound">v₁</a> <a id="3921" href="/Denotational/#4159" class="InductiveConstructor Operator">⊔</a> <a id="3923" href="/Compositional/#3923" class="Bound">v₂</a><a id="3925" class="Symbol">}</a> <a id="3927" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="3929" href="/Compositional/#3929" class="Bound">d1</a> <a id="3932" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3934" href="/Compositional/#3934" class="Bound">d2</a> <a id="3937" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="3939" class="Symbol">=</a> <a id="3941" href="/Denotational/#10326" class="InductiveConstructor">⊔-intro</a> <a id="3949" class="Symbol">(</a><a id="3950" href="/Compositional/#3730" class="Function">ℱℰ→ℰƛ</a> <a id="3956" href="/Compositional/#3929" class="Bound">d1</a><a id="3958" class="Symbol">)</a> <a id="3960" class="Symbol">(</a><a id="3961" href="/Compositional/#3730" class="Function">ℱℰ→ℰƛ</a> <a id="3967" href="/Compositional/#3934" class="Bound">d2</a><a id="3969" class="Symbol">)</a></pre>

<p>So indeed, the denotational semantics is composititional with respect
to lambda abstraction, as witnessed by the function <code class="highlighter-rouge">ℱ</code>.</p>

<pre class="Agda"><a id="lam-equiv"></a><a id="4124" href="/Compositional/#4124" class="Function">lam-equiv</a> <a id="4134" class="Symbol">:</a> <a id="4136" class="Symbol">∀{</a><a id="4138" href="/Compositional/#4138" class="Bound">Γ</a><a id="4139" class="Symbol">}{</a><a id="4141" href="/Compositional/#4141" class="Bound">γ</a> <a id="4143" class="Symbol">:</a> <a id="4145" href="/Denotational/#7331" class="Function">Env</a> <a id="4149" href="/Compositional/#4138" class="Bound">Γ</a><a id="4150" class="Symbol">}{</a><a id="4152" href="/Compositional/#4152" class="Bound">M</a> <a id="4154" class="Symbol">:</a> <a id="4156" href="/Compositional/#4138" class="Bound">Γ</a> <a id="4158" href="/Untyped/#3018" class="InductiveConstructor Operator">,</a> <a id="4160" href="/Untyped/#2694" class="InductiveConstructor">★</a> <a id="4162" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="4164" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="4165" class="Symbol">}</a>
          <a id="4177" class="Symbol">→</a> <a id="4179" href="/Denotational/#18334" class="Function">ℰ</a> <a id="4181" class="Symbol">(</a><a id="4182" href="/Untyped/#4238" class="InductiveConstructor Operator">ƛ</a> <a id="4184" href="/Compositional/#4152" class="Bound">M</a><a id="4185" class="Symbol">)</a> <a id="4187" href="/Denotational/#18532" class="Function Operator">≃</a> <a id="4189" href="/Compositional/#1674" class="Function">ℱ</a> <a id="4191" class="Symbol">(</a><a id="4192" href="/Denotational/#18334" class="Function">ℰ</a> <a id="4194" href="/Compositional/#4152" class="Bound">M</a><a id="4195" class="Symbol">)</a>
<a id="4197" href="/Compositional/#4124" class="Function">lam-equiv</a> <a id="4207" class="Symbol">=</a> <a id="4209" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="4211" href="/Compositional/#2928" class="Function">ℰƛ→ℱℰ</a> <a id="4217" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="4219" href="/Compositional/#3730" class="Function">ℱℰ→ℰƛ</a> <a id="4225" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a></pre>

<p>Next we consider function application. For this we need to define a
function that takes two denotations, both in context <code class="highlighter-rouge">Γ</code>, and produces
another one in context <code class="highlighter-rouge">Γ</code>. This function, let us name it <code class="highlighter-rouge">●</code>, needs to
mimic the non-recursive aspects of the semantics of an application <code class="highlighter-rouge">L · M</code>.
We cannot proceed as easily as for <code class="highlighter-rouge">ℱ</code> and define the function by
recursion on value <code class="highlighter-rouge">v</code> because, for example, the rule <code class="highlighter-rouge">↦-elim</code> applies
to any value. Instead we shall define <code class="highlighter-rouge">●</code> in a way that directly deals
with the <code class="highlighter-rouge">↦-elim</code> and <code class="highlighter-rouge">⊥-intro</code> rules but ignores <code class="highlighter-rouge">⊔-intro</code>. This
makes the forward direction of the proof more difficult, and the case
for <code class="highlighter-rouge">⊔-intro</code> demonstrates why the <code class="highlighter-rouge">Dist⊑</code> rule is important.</p>

<p>So we define the application of <code class="highlighter-rouge">D₁</code> to <code class="highlighter-rouge">D₂</code>, written <code class="highlighter-rouge">D₁ ● D₂</code>, to include
any value <code class="highlighter-rouge">w</code> equivalent to <code class="highlighter-rouge">⊥</code>, for the <code class="highlighter-rouge">⊥-intro</code> rule, and to include any
value <code class="highlighter-rouge">w</code> that is the output of an entry <code class="highlighter-rouge">v ↦ w</code> in <code class="highlighter-rouge">D₁</code>, provided the
input <code class="highlighter-rouge">v</code> is in <code class="highlighter-rouge">D₂</code>, for the <code class="highlighter-rouge">↦-elim</code> rule.</p>

<pre class="Agda"><a id="5215" class="Keyword">infixl</a> <a id="5222" class="Number">7</a> <a id="5224" href="/Compositional/#5229" class="Function Operator">_●_</a>

<a id="_●_"></a><a id="5229" href="/Compositional/#5229" class="Function Operator">_●_</a> <a id="5233" class="Symbol">:</a> <a id="5235" class="Symbol">∀{</a><a id="5237" href="/Compositional/#5237" class="Bound">Γ</a><a id="5238" class="Symbol">}</a> <a id="5240" class="Symbol">→</a> <a id="5242" href="/Denotational/#18105" class="Function">Denotation</a> <a id="5253" href="/Compositional/#5237" class="Bound">Γ</a> <a id="5255" class="Symbol">→</a> <a id="5257" href="/Denotational/#18105" class="Function">Denotation</a> <a id="5268" href="/Compositional/#5237" class="Bound">Γ</a> <a id="5270" class="Symbol">→</a> <a id="5272" href="/Denotational/#18105" class="Function">Denotation</a> <a id="5283" href="/Compositional/#5237" class="Bound">Γ</a>
<a id="5285" class="Symbol">(</a><a id="5286" href="/Compositional/#5286" class="Bound">D₁</a> <a id="5289" href="/Compositional/#5229" class="Function Operator">●</a> <a id="5291" href="/Compositional/#5291" class="Bound">D₂</a><a id="5293" class="Symbol">)</a> <a id="5295" href="/Compositional/#5295" class="Bound">γ</a> <a id="5297" href="/Compositional/#5297" class="Bound">w</a> <a id="5299" class="Symbol">=</a> <a id="5301" href="/Compositional/#5297" class="Bound">w</a> <a id="5303" href="/Denotational/#4468" class="Datatype Operator">⊑</a> <a id="5305" href="/Denotational/#4117" class="InductiveConstructor">⊥</a> <a id="5307" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#419" class="Datatype Operator">⊎</a> <a id="5309" href="https://agda.github.io/agda-stdlib/Data.Product.html#764" class="Function">Σ[</a> <a id="5312" href="/Compositional/#5312" class="Bound">v</a> <a id="5314" href="https://agda.github.io/agda-stdlib/Data.Product.html#764" class="Function">∈</a> <a id="5316" href="/Denotational/#4097" class="Datatype">Value</a> <a id="5322" href="https://agda.github.io/agda-stdlib/Data.Product.html#764" class="Function">]</a><a id="5323" class="Symbol">(</a> <a id="5325" href="/Compositional/#5286" class="Bound">D₁</a> <a id="5328" href="/Compositional/#5295" class="Bound">γ</a> <a id="5330" class="Symbol">(</a><a id="5331" href="/Compositional/#5312" class="Bound">v</a> <a id="5333" href="/Denotational/#4129" class="InductiveConstructor Operator">↦</a> <a id="5335" href="/Compositional/#5297" class="Bound">w</a><a id="5336" class="Symbol">)</a> <a id="5338" href="https://agda.github.io/agda-stdlib/Data.Product.html#1353" class="Function Operator">×</a> <a id="5340" href="/Compositional/#5291" class="Bound">D₂</a> <a id="5343" href="/Compositional/#5295" class="Bound">γ</a> <a id="5345" href="/Compositional/#5312" class="Bound">v</a> <a id="5347" class="Symbol">)</a></pre>

<p>Next we consider the inversion lemma for application, which is also
the forward direction of the semantic equation for application.  We
describe the proof below.</p>

<pre class="Agda"><a id="ℰ·→●ℰ"></a><a id="5537" href="/Compositional/#5537" class="Function">ℰ·→●ℰ</a> <a id="5543" class="Symbol">:</a> <a id="5545" class="Symbol">∀{</a><a id="5547" href="/Compositional/#5547" class="Bound">Γ</a><a id="5548" class="Symbol">}{</a><a id="5550" href="/Compositional/#5550" class="Bound">γ</a> <a id="5552" class="Symbol">:</a> <a id="5554" href="/Denotational/#7331" class="Function">Env</a> <a id="5558" href="/Compositional/#5547" class="Bound">Γ</a><a id="5559" class="Symbol">}{</a><a id="5561" href="/Compositional/#5561" class="Bound">L</a> <a id="5563" href="/Compositional/#5563" class="Bound">M</a> <a id="5565" class="Symbol">:</a> <a id="5567" href="/Compositional/#5547" class="Bound">Γ</a> <a id="5569" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="5571" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="5572" class="Symbol">}{</a><a id="5574" href="/Compositional/#5574" class="Bound">v</a> <a id="5576" class="Symbol">:</a> <a id="5578" href="/Denotational/#4097" class="Datatype">Value</a><a id="5583" class="Symbol">}</a>
        <a id="5593" class="Symbol">→</a> <a id="5595" href="/Denotational/#18334" class="Function">ℰ</a> <a id="5597" class="Symbol">(</a><a id="5598" href="/Compositional/#5561" class="Bound">L</a> <a id="5600" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="5602" href="/Compositional/#5563" class="Bound">M</a><a id="5603" class="Symbol">)</a> <a id="5605" href="/Compositional/#5550" class="Bound">γ</a> <a id="5607" href="/Compositional/#5574" class="Bound">v</a>
          <a id="5619" class="Comment">----------------</a>
        <a id="5644" class="Symbol">→</a> <a id="5646" class="Symbol">(</a><a id="5647" href="/Denotational/#18334" class="Function">ℰ</a> <a id="5649" href="/Compositional/#5561" class="Bound">L</a> <a id="5651" href="/Compositional/#5229" class="Function Operator">●</a> <a id="5653" href="/Denotational/#18334" class="Function">ℰ</a> <a id="5655" href="/Compositional/#5563" class="Bound">M</a><a id="5656" class="Symbol">)</a> <a id="5658" href="/Compositional/#5550" class="Bound">γ</a> <a id="5660" href="/Compositional/#5574" class="Bound">v</a>
<a id="5662" href="/Compositional/#5537" class="Function">ℰ·→●ℰ</a> <a id="5668" class="Symbol">(</a><a id="5669" href="/Denotational/#9989" class="InductiveConstructor">↦-elim</a><a id="5675" class="Symbol">{</a><a id="5676" class="Argument">v</a> <a id="5678" class="Symbol">=</a> <a id="5680" href="/Compositional/#5680" class="Bound">v&#39;</a><a id="5682" class="Symbol">}</a> <a id="5684" href="/Compositional/#5684" class="Bound">d₁</a> <a id="5687" href="/Compositional/#5687" class="Bound">d₂</a><a id="5689" class="Symbol">)</a> <a id="5691" class="Symbol">=</a> <a id="5693" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="5698" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="5700" href="/Compositional/#5680" class="Bound">v&#39;</a> <a id="5703" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="5705" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="5707" href="/Compositional/#5684" class="Bound">d₁</a> <a id="5710" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="5712" href="/Compositional/#5687" class="Bound">d₂</a> <a id="5715" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="5717" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>
<a id="5719" href="/Compositional/#5537" class="Function">ℰ·→●ℰ</a> <a id="5725" class="Symbol">{</a><a id="5726" class="Argument">v</a> <a id="5728" class="Symbol">=</a> <a id="5730" href="/Denotational/#4117" class="InductiveConstructor">⊥</a><a id="5731" class="Symbol">}</a> <a id="5733" href="/Denotational/#10251" class="InductiveConstructor">⊥-intro</a> <a id="5741" class="Symbol">=</a> <a id="5743" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="5748" href="/Denotational/#4503" class="InductiveConstructor">Bot⊑</a>
<a id="5753" href="/Compositional/#5537" class="Function">ℰ·→●ℰ</a> <a id="5759" class="Symbol">{</a><a id="5760" href="/Compositional/#5760" class="Bound">Γ</a><a id="5761" class="Symbol">}{</a><a id="5763" href="/Compositional/#5763" class="Bound">γ</a><a id="5764" class="Symbol">}{</a><a id="5766" href="/Compositional/#5766" class="Bound">L</a><a id="5767" class="Symbol">}{</a><a id="5769" href="/Compositional/#5769" class="Bound">M</a><a id="5770" class="Symbol">}{</a><a id="5772" href="/Compositional/#5772" class="Bound">v</a><a id="5773" class="Symbol">}</a> <a id="5775" class="Symbol">(</a><a id="5776" href="/Denotational/#10326" class="InductiveConstructor">⊔-intro</a><a id="5783" class="Symbol">{</a><a id="5784" class="Argument">v</a> <a id="5786" class="Symbol">=</a> <a id="5788" href="/Compositional/#5788" class="Bound">v₁</a><a id="5790" class="Symbol">}{</a><a id="5792" class="Argument">w</a> <a id="5794" class="Symbol">=</a> <a id="5796" href="/Compositional/#5796" class="Bound">v₂</a><a id="5798" class="Symbol">}</a> <a id="5800" href="/Compositional/#5800" class="Bound">d₁</a> <a id="5803" href="/Compositional/#5803" class="Bound">d₂</a><a id="5805" class="Symbol">)</a> 
    <a id="5812" class="Keyword">with</a> <a id="5817" href="/Compositional/#5537" class="Function">ℰ·→●ℰ</a> <a id="5823" href="/Compositional/#5800" class="Bound">d₁</a> <a id="5826" class="Symbol">|</a> <a id="5828" href="/Compositional/#5537" class="Function">ℰ·→●ℰ</a> <a id="5834" href="/Compositional/#5803" class="Bound">d₂</a>
<a id="5837" class="Symbol">...</a> <a id="5841" class="Symbol">|</a> <a id="5843" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="5848" href="/Compositional/#5848" class="Bound">lt1</a> <a id="5852" class="Symbol">|</a> <a id="5854" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="5859" href="/Compositional/#5859" class="Bound">lt2</a> <a id="5863" class="Symbol">=</a> <a id="5865" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="5870" class="Symbol">(</a><a id="5871" href="/Denotational/#4527" class="InductiveConstructor">ConjL⊑</a> <a id="5878" href="/Compositional/#5848" class="Bound">lt1</a> <a id="5882" href="/Compositional/#5859" class="Bound">lt2</a><a id="5885" class="Symbol">)</a>    
<a id="5891" class="Symbol">...</a> <a id="5895" class="Symbol">|</a> <a id="5897" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="5902" href="/Compositional/#5902" class="Bound">lt1</a> <a id="5906" class="Symbol">|</a> <a id="5908" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="5913" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="5915" href="/Compositional/#5915" class="Bound">v₁&#39;</a> <a id="5919" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="5921" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="5923" href="/Compositional/#5923" class="Bound">L↓v12</a> <a id="5929" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="5931" href="/Compositional/#5931" class="Bound">M↓v3</a> <a id="5936" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="5938" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="5940" class="Symbol">=</a>
      <a id="5948" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="5953" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="5955" href="/Compositional/#5915" class="Bound">v₁&#39;</a> <a id="5959" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="5961" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="5963" href="/Denotational/#10462" class="InductiveConstructor">sub</a> <a id="5967" href="/Compositional/#5923" class="Bound">L↓v12</a> <a id="5973" href="/Compositional/#5999" class="Function">lt</a> <a id="5976" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="5978" href="/Compositional/#5931" class="Bound">M↓v3</a> <a id="5983" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="5985" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>
      <a id="5993" class="Keyword">where</a> <a id="5999" href="/Compositional/#5999" class="Function">lt</a> <a id="6002" class="Symbol">:</a> <a id="6004" href="/Compositional/#5915" class="Bound">v₁&#39;</a> <a id="6008" href="/Denotational/#4129" class="InductiveConstructor Operator">↦</a> <a id="6010" class="Symbol">(</a><a id="6011" class="Bound">v₁</a> <a id="6014" href="/Denotational/#4159" class="InductiveConstructor Operator">⊔</a> <a id="6016" class="Bound">v₂</a><a id="6018" class="Symbol">)</a> <a id="6020" href="/Denotational/#4468" class="Datatype Operator">⊑</a> <a id="6022" href="/Compositional/#5915" class="Bound">v₁&#39;</a> <a id="6026" href="/Denotational/#4129" class="InductiveConstructor Operator">↦</a> <a id="6028" class="Bound">v₂</a>
            <a id="6043" href="/Compositional/#5999" class="Function">lt</a> <a id="6046" class="Symbol">=</a> <a id="6048" class="Symbol">(</a><a id="6049" href="/Denotational/#4839" class="InductiveConstructor">Fun⊑</a> <a id="6054" href="/Denotational/#5638" class="Function">Refl⊑</a> <a id="6060" class="Symbol">(</a><a id="6061" href="/Denotational/#4527" class="InductiveConstructor">ConjL⊑</a> <a id="6068" class="Symbol">(</a><a id="6069" href="/Denotational/#4765" class="InductiveConstructor">Trans⊑</a> <a id="6076" href="/Compositional/#5902" class="Bound">lt1</a> <a id="6080" href="/Denotational/#4503" class="InductiveConstructor">Bot⊑</a><a id="6084" class="Symbol">)</a> <a id="6086" href="/Denotational/#5638" class="Function">Refl⊑</a><a id="6091" class="Symbol">))</a>
<a id="6094" class="Symbol">...</a> <a id="6098" class="Symbol">|</a> <a id="6100" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="6105" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6107" href="/Compositional/#6107" class="Bound">v₁&#39;</a> <a id="6111" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6113" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6115" href="/Compositional/#6115" class="Bound">L↓v12</a> <a id="6121" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6123" href="/Compositional/#6123" class="Bound">M↓v3</a> <a id="6128" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6130" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6132" class="Symbol">|</a> <a id="6134" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="6139" href="/Compositional/#6139" class="Bound">lt2</a> <a id="6143" class="Symbol">=</a>
      <a id="6151" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="6156" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6158" href="/Compositional/#6107" class="Bound">v₁&#39;</a> <a id="6162" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6164" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6166" href="/Denotational/#10462" class="InductiveConstructor">sub</a> <a id="6170" href="/Compositional/#6115" class="Bound">L↓v12</a> <a id="6176" href="/Compositional/#6202" class="Function">lt</a> <a id="6179" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6181" href="/Compositional/#6123" class="Bound">M↓v3</a> <a id="6186" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6188" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>
      <a id="6196" class="Keyword">where</a> <a id="6202" href="/Compositional/#6202" class="Function">lt</a> <a id="6205" class="Symbol">:</a> <a id="6207" href="/Compositional/#6107" class="Bound">v₁&#39;</a> <a id="6211" href="/Denotational/#4129" class="InductiveConstructor Operator">↦</a> <a id="6213" class="Symbol">(</a><a id="6214" class="Bound">v₁</a> <a id="6217" href="/Denotational/#4159" class="InductiveConstructor Operator">⊔</a> <a id="6219" class="Bound">v₂</a><a id="6221" class="Symbol">)</a> <a id="6223" href="/Denotational/#4468" class="Datatype Operator">⊑</a> <a id="6225" href="/Compositional/#6107" class="Bound">v₁&#39;</a> <a id="6229" href="/Denotational/#4129" class="InductiveConstructor Operator">↦</a> <a id="6231" class="Bound">v₁</a>
            <a id="6246" href="/Compositional/#6202" class="Function">lt</a> <a id="6249" class="Symbol">=</a> <a id="6251" class="Symbol">(</a><a id="6252" href="/Denotational/#4839" class="InductiveConstructor">Fun⊑</a> <a id="6257" href="/Denotational/#5638" class="Function">Refl⊑</a> <a id="6263" class="Symbol">(</a><a id="6264" href="/Denotational/#4527" class="InductiveConstructor">ConjL⊑</a> <a id="6271" href="/Denotational/#5638" class="Function">Refl⊑</a> <a id="6277" class="Symbol">(</a><a id="6278" href="/Denotational/#4765" class="InductiveConstructor">Trans⊑</a> <a id="6285" href="/Compositional/#6139" class="Bound">lt2</a> <a id="6289" href="/Denotational/#4503" class="InductiveConstructor">Bot⊑</a><a id="6293" class="Symbol">)))</a>
<a id="6297" class="Symbol">...</a> <a id="6301" class="Symbol">|</a> <a id="6303" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="6308" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6310" href="/Compositional/#6310" class="Bound">v₁&#39;</a> <a id="6314" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6316" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6318" href="/Compositional/#6318" class="Bound">L↓v12</a> <a id="6324" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6326" href="/Compositional/#6326" class="Bound">M↓v3</a> <a id="6331" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6333" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6335" class="Symbol">|</a> <a id="6337" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="6342" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6344" href="/Compositional/#6344" class="Bound">v₁&#39;&#39;</a> <a id="6349" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6351" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6353" href="/Compositional/#6353" class="Bound">L↓v12&#39;</a> <a id="6360" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6362" href="/Compositional/#6362" class="Bound">M↓v3&#39;</a> <a id="6368" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6370" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6372" class="Symbol">=</a>
      <a id="6380" class="Keyword">let</a> <a id="6384" href="/Compositional/#6384" class="Bound">L↓⊔</a> <a id="6388" class="Symbol">=</a> <a id="6390" href="/Denotational/#10326" class="InductiveConstructor">⊔-intro</a> <a id="6398" href="/Compositional/#6318" class="Bound">L↓v12</a> <a id="6404" href="/Compositional/#6353" class="Bound">L↓v12&#39;</a> <a id="6411" class="Keyword">in</a>
      <a id="6420" class="Keyword">let</a> <a id="6424" href="/Compositional/#6424" class="Bound">M↓⊔</a> <a id="6428" class="Symbol">=</a> <a id="6430" href="/Denotational/#10326" class="InductiveConstructor">⊔-intro</a> <a id="6438" href="/Compositional/#6326" class="Bound">M↓v3</a> <a id="6443" href="/Compositional/#6362" class="Bound">M↓v3&#39;</a> <a id="6449" class="Keyword">in</a>
      <a id="6458" class="Keyword">let</a> <a id="6462" href="/Compositional/#6462" class="Bound">x</a> <a id="6464" class="Symbol">=</a> <a id="6466" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="6471" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6473" href="/Compositional/#6310" class="Bound">v₁&#39;</a> <a id="6477" href="/Denotational/#4159" class="InductiveConstructor Operator">⊔</a> <a id="6479" href="/Compositional/#6344" class="Bound">v₁&#39;&#39;</a> <a id="6484" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6486" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6488" href="/Denotational/#10462" class="InductiveConstructor">sub</a> <a id="6492" href="/Compositional/#6384" class="Bound">L↓⊔</a> <a id="6496" href="/Denotational/#6293" class="Function">Dist⊔↦⊔</a> <a id="6504" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6506" href="/Compositional/#6424" class="Bound">M↓⊔</a> <a id="6510" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6512" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6514" class="Keyword">in</a>
      <a id="6523" href="/Compositional/#6462" class="Bound">x</a>
<a id="6525" href="/Compositional/#5537" class="Function">ℰ·→●ℰ</a> <a id="6531" class="Symbol">{</a><a id="6532" href="/Compositional/#6532" class="Bound">Γ</a><a id="6533" class="Symbol">}{</a><a id="6535" href="/Compositional/#6535" class="Bound">γ</a><a id="6536" class="Symbol">}{</a><a id="6538" href="/Compositional/#6538" class="Bound">L</a><a id="6539" class="Symbol">}{</a><a id="6541" href="/Compositional/#6541" class="Bound">M</a><a id="6542" class="Symbol">}{</a><a id="6544" href="/Compositional/#6544" class="Bound">v</a><a id="6545" class="Symbol">}</a> <a id="6547" class="Symbol">(</a><a id="6548" href="/Denotational/#10462" class="InductiveConstructor">sub</a> <a id="6552" href="/Compositional/#6552" class="Bound">d</a> <a id="6554" href="/Compositional/#6554" class="Bound">lt</a><a id="6556" class="Symbol">)</a>
    <a id="6562" class="Keyword">with</a> <a id="6567" href="/Compositional/#5537" class="Function">ℰ·→●ℰ</a> <a id="6573" href="/Compositional/#6552" class="Bound">d</a>
<a id="6575" class="Symbol">...</a> <a id="6579" class="Symbol">|</a> <a id="6581" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="6586" href="/Compositional/#6586" class="Bound">lt2</a> <a id="6590" class="Symbol">=</a> <a id="6592" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="6597" class="Symbol">(</a><a id="6598" href="/Denotational/#4765" class="InductiveConstructor">Trans⊑</a> <a id="6605" class="Bound">lt</a> <a id="6608" href="/Compositional/#6586" class="Bound">lt2</a><a id="6611" class="Symbol">)</a>
<a id="6613" class="Symbol">...</a> <a id="6617" class="Symbol">|</a> <a id="6619" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="6624" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6626" href="/Compositional/#6626" class="Bound">v₁</a> <a id="6629" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6631" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6633" href="/Compositional/#6633" class="Bound">L↓v12</a> <a id="6639" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6641" href="/Compositional/#6641" class="Bound">M↓v3</a> <a id="6646" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6648" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6650" class="Symbol">=</a>
      <a id="6658" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="6663" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6665" href="/Compositional/#6626" class="Bound">v₁</a> <a id="6668" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6670" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="6672" href="/Denotational/#10462" class="InductiveConstructor">sub</a> <a id="6676" href="/Compositional/#6633" class="Bound">L↓v12</a> <a id="6682" class="Symbol">(</a><a id="6683" href="/Denotational/#4839" class="InductiveConstructor">Fun⊑</a> <a id="6688" href="/Denotational/#5638" class="Function">Refl⊑</a> <a id="6694" class="Bound">lt</a><a id="6696" class="Symbol">)</a> <a id="6698" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="6700" href="/Compositional/#6641" class="Bound">M↓v3</a> <a id="6705" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="6707" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a></pre>

<p>We proceed by induction on the semantics.</p>

<ul>
  <li>
    <p>In case <code class="highlighter-rouge">↦-elim</code> we have <code class="highlighter-rouge">γ ⊢ L ↓ (v' ↦ v)</code> and <code class="highlighter-rouge">γ ⊢ M ↓ v'</code>,
which is all we need to show <code class="highlighter-rouge">(ℰ L ● ℰ M) γ v</code>.</p>
  </li>
  <li>
    <p>In case <code class="highlighter-rouge">⊥-intro</code> we have <code class="highlighter-rouge">v = ⊥</code>. We conclude that <code class="highlighter-rouge">v ⊑ ⊥</code>.</p>
  </li>
  <li>
    <p>In case <code class="highlighter-rouge">⊔-intro</code> we have <code class="highlighter-rouge">ℰ (L · M) γ v₁</code> and <code class="highlighter-rouge">ℰ (L · M) γ v₂</code>
and need to show <code class="highlighter-rouge">(ℰ L ● ℰ M) γ (v₁ ⊔ v₂)</code>. By the induction
hypothesis, we have <code class="highlighter-rouge">(ℰ L ● ℰ M) γ v₁</code> and <code class="highlighter-rouge">(ℰ L ● ℰ M) γ v₂</code>.
We have four subcases to consider.</p>

    <ul>
      <li>Suppose <code class="highlighter-rouge">v₁ ⊑ ⊥</code> and <code class="highlighter-rouge">v₂ ⊑ ⊥</code>. Then <code class="highlighter-rouge">v₁ ⊔ v₂ ⊑ ⊥</code>.</li>
      <li>Suppose <code class="highlighter-rouge">v₁ ⊑ ⊥</code>, <code class="highlighter-rouge">γ ⊢ L ↓ v₁' ↦ v₂</code>, and <code class="highlighter-rouge">γ ⊢ M ↓ v₁'</code>.
We have <code class="highlighter-rouge">γ ⊢ L ↓ v₁' ↦ (v₁ ⊔ v₂)</code> by rule <code class="highlighter-rouge">sub</code>
because <code class="highlighter-rouge">v₁' ↦ (v₁ ⊔ v₂) ⊑ v₁' ↦ v₂</code>.</li>
      <li>Suppose <code class="highlighter-rouge">γ ⊢ L ↓ v₁' ↦ v₁</code>, <code class="highlighter-rouge">γ ⊢ M ↓ v₁'</code>, and <code class="highlighter-rouge">v₂ ⊑ ⊥</code>.
We have <code class="highlighter-rouge">γ ⊢ L ↓ v₁' ↦ (v₁ ⊔ v₂)</code> by rule <code class="highlighter-rouge">sub</code>
because <code class="highlighter-rouge">v₁' ↦ (v₁ ⊔ v₂) ⊑ v₁' ↦ v₁</code>.</li>
      <li>
        <p>Suppose <code class="highlighter-rouge">γ ⊢ L ↓ v₁'' ↦ v₁, γ ⊢ M ↓ v₁''</code>,
<code class="highlighter-rouge">γ ⊢ L ↓ v₁' ↦ v₂</code>, and <code class="highlighter-rouge">γ ⊢ M ↓ v₁'</code>.
This case is the most interesting.
By two uses of the rule <code class="highlighter-rouge">⊔-intro</code> we have
<code class="highlighter-rouge">γ ⊢ L ↓ (v₁' ↦ v₂) ⊔ (v₁'' ↦ v₁)</code> and
<code class="highlighter-rouge">γ ⊢ M ↓ (v₁' ⊔ v₁'')</code>. But this does not yet match
what we need for <code class="highlighter-rouge">ℰ L ● ℰ M</code> because the result of
<code class="highlighter-rouge">L</code> must be an <code class="highlighter-rouge">↦</code> whose input entry is <code class="highlighter-rouge">v₁' ⊔ v₁''</code>.
So we use the <code class="highlighter-rouge">sub</code> rule to obtain 
<code class="highlighter-rouge">γ ⊢ L ↓ (v₁' ⊔ v₁'') ↦ (v₁ ⊔ v₂)</code>,
using the <code class="highlighter-rouge">Dist⊔→⊔</code> lemma (thanks to the <code class="highlighter-rouge">Dist⊑</code> rule) to
show that</p>

        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  (v₁' ⊔ v₁'') ↦ (v₁ ⊔ v₂) ⊑ (v₁' ↦ v₂) ⊔ (v₁'' ↦ v₁)
</code></pre></div>        </div>

        <p>So we have proved what is needed for this case.</p>
      </li>
    </ul>
  </li>
  <li>
    <p>In case <code class="highlighter-rouge">sub</code> we have <code class="highlighter-rouge">Γ ⊢ L · M ↓ v₁</code> and <code class="highlighter-rouge">v ⊑ v₁</code>.
By the induction hypothesis, we have <code class="highlighter-rouge">(ℰ L ● ℰ M) γ v₁</code>.
We have two subcases to consider.</p>

    <ul>
      <li>Suppose <code class="highlighter-rouge">v₁ ⊑ ⊥</code>. We conclude that <code class="highlighter-rouge">v ⊑ ⊥</code>.</li>
      <li>Suppose <code class="highlighter-rouge">Γ ⊢ L ↓ v' → v₁</code> and <code class="highlighter-rouge">Γ ⊢ M ↓ v'</code>.
We conclude with <code class="highlighter-rouge">Γ ⊢ L ↓ v' → v</code> by rule <code class="highlighter-rouge">sub</code>, because
<code class="highlighter-rouge">v' → v ⊑ v' → v₁</code>.</li>
    </ul>
  </li>
</ul>

<p>The foward direction is proved by cases on the premise <code class="highlighter-rouge">(ℰ L ● ℰ M) γ v</code>.
In case <code class="highlighter-rouge">v ⊑ ⊥</code>, we obtain <code class="highlighter-rouge">Γ ⊢ L · M ↓ ⊥</code> by rule <code class="highlighter-rouge">⊥-intro</code>.
Otherwise, we conclude immediately by rule <code class="highlighter-rouge">↦-elim</code>.</p>

<pre class="Agda"><a id="●ℰ→ℰ·"></a><a id="8794" href="/Compositional/#8794" class="Function">●ℰ→ℰ·</a> <a id="8800" class="Symbol">:</a> <a id="8802" class="Symbol">∀{</a><a id="8804" href="/Compositional/#8804" class="Bound">Γ</a><a id="8805" class="Symbol">}{</a><a id="8807" href="/Compositional/#8807" class="Bound">γ</a> <a id="8809" class="Symbol">:</a> <a id="8811" href="/Denotational/#7331" class="Function">Env</a> <a id="8815" href="/Compositional/#8804" class="Bound">Γ</a><a id="8816" class="Symbol">}{</a><a id="8818" href="/Compositional/#8818" class="Bound">L</a> <a id="8820" href="/Compositional/#8820" class="Bound">M</a> <a id="8822" class="Symbol">:</a> <a id="8824" href="/Compositional/#8804" class="Bound">Γ</a> <a id="8826" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="8828" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="8829" class="Symbol">}{</a><a id="8831" href="/Compositional/#8831" class="Bound">v</a><a id="8832" class="Symbol">}</a>
      <a id="8840" class="Symbol">→</a> <a id="8842" class="Symbol">(</a><a id="8843" href="/Denotational/#18334" class="Function">ℰ</a> <a id="8845" href="/Compositional/#8818" class="Bound">L</a> <a id="8847" href="/Compositional/#5229" class="Function Operator">●</a> <a id="8849" href="/Denotational/#18334" class="Function">ℰ</a> <a id="8851" href="/Compositional/#8820" class="Bound">M</a><a id="8852" class="Symbol">)</a> <a id="8854" href="/Compositional/#8807" class="Bound">γ</a> <a id="8856" href="/Compositional/#8831" class="Bound">v</a>
        <a id="8866" class="Comment">----------------</a>
      <a id="8889" class="Symbol">→</a> <a id="8891" href="/Denotational/#18334" class="Function">ℰ</a> <a id="8893" class="Symbol">(</a><a id="8894" href="/Compositional/#8818" class="Bound">L</a> <a id="8896" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="8898" href="/Compositional/#8820" class="Bound">M</a><a id="8899" class="Symbol">)</a> <a id="8901" href="/Compositional/#8807" class="Bound">γ</a> <a id="8903" href="/Compositional/#8831" class="Bound">v</a>
<a id="8905" href="/Compositional/#8794" class="Function">●ℰ→ℰ·</a> <a id="8911" class="Symbol">{</a><a id="8912" href="/Compositional/#8912" class="Bound">γ</a><a id="8913" class="Symbol">}{</a><a id="8915" href="/Compositional/#8915" class="Bound">v</a><a id="8916" class="Symbol">}</a> <a id="8918" class="Symbol">(</a><a id="8919" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a> <a id="8924" href="/Compositional/#8924" class="Bound">lt</a><a id="8926" class="Symbol">)</a> <a id="8928" class="Symbol">=</a> <a id="8930" href="/Denotational/#10462" class="InductiveConstructor">sub</a> <a id="8934" href="/Denotational/#10251" class="InductiveConstructor">⊥-intro</a> <a id="8942" href="/Compositional/#8924" class="Bound">lt</a>
<a id="8945" href="/Compositional/#8794" class="Function">●ℰ→ℰ·</a> <a id="8951" class="Symbol">{</a><a id="8952" href="/Compositional/#8952" class="Bound">γ</a><a id="8953" class="Symbol">}{</a><a id="8955" href="/Compositional/#8955" class="Bound">v</a><a id="8956" class="Symbol">}</a> <a id="8958" class="Symbol">(</a><a id="8959" href="https://agda.github.io/agda-stdlib/Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a> <a id="8964" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="8966" href="/Compositional/#8966" class="Bound">v₁</a> <a id="8969" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="8971" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="8973" href="/Compositional/#8973" class="Bound">d1</a> <a id="8976" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="8978" href="/Compositional/#8978" class="Bound">d2</a> <a id="8981" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="8983" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a><a id="8984" class="Symbol">)</a> <a id="8986" class="Symbol">=</a> <a id="8988" href="/Denotational/#9989" class="InductiveConstructor">↦-elim</a> <a id="8995" href="/Compositional/#8973" class="Bound">d1</a> <a id="8998" href="/Compositional/#8978" class="Bound">d2</a></pre>

<p>So we have proved that the semantics is compositional with respect to
function application, as witnessed by the <code class="highlighter-rouge">●</code> function.</p>

<pre class="Agda"><a id="app-equiv"></a><a id="9153" href="/Compositional/#9153" class="Function">app-equiv</a> <a id="9163" class="Symbol">:</a> <a id="9165" class="Symbol">∀{</a><a id="9167" href="/Compositional/#9167" class="Bound">Γ</a><a id="9168" class="Symbol">}{</a><a id="9170" href="/Compositional/#9170" class="Bound">γ</a> <a id="9172" class="Symbol">:</a> <a id="9174" href="/Denotational/#7331" class="Function">Env</a> <a id="9178" href="/Compositional/#9167" class="Bound">Γ</a><a id="9179" class="Symbol">}{</a><a id="9181" href="/Compositional/#9181" class="Bound">L</a> <a id="9183" href="/Compositional/#9183" class="Bound">M</a> <a id="9185" class="Symbol">:</a> <a id="9187" href="/Compositional/#9167" class="Bound">Γ</a> <a id="9189" href="/Untyped/#4150" class="Datatype Operator">⊢</a> <a id="9191" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="9192" class="Symbol">}</a>
          <a id="9204" class="Symbol">→</a> <a id="9206" href="/Denotational/#18334" class="Function">ℰ</a> <a id="9208" class="Symbol">(</a><a id="9209" href="/Compositional/#9181" class="Bound">L</a> <a id="9211" href="/Untyped/#4298" class="InductiveConstructor Operator">·</a> <a id="9213" href="/Compositional/#9183" class="Bound">M</a><a id="9214" class="Symbol">)</a> <a id="9216" href="/Denotational/#18532" class="Function Operator">≃</a> <a id="9218" class="Symbol">(</a><a id="9219" href="/Denotational/#18334" class="Function">ℰ</a> <a id="9221" href="/Compositional/#9181" class="Bound">L</a><a id="9222" class="Symbol">)</a> <a id="9224" href="/Compositional/#5229" class="Function Operator">●</a> <a id="9226" class="Symbol">(</a><a id="9227" href="/Denotational/#18334" class="Function">ℰ</a> <a id="9229" href="/Compositional/#9183" class="Bound">M</a><a id="9230" class="Symbol">)</a>
<a id="9232" href="/Compositional/#9153" class="Function">app-equiv</a> <a id="9242" class="Symbol">=</a> <a id="9244" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="9246" href="/Compositional/#5537" class="Function">ℰ·→●ℰ</a> <a id="9252" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="9254" href="/Compositional/#8794" class="Function">●ℰ→ℰ·</a> <a id="9260" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a></pre>

<p>We also need an inversion lemma for variables.
If <code class="highlighter-rouge">Γ ⊢ x ↓ v</code>, then <code class="highlighter-rouge">v ⊑ nth x γ</code>. The proof is a straightforward
induction on the semantics.</p>

<pre class="Agda"><a id="var-inv"></a><a id="9430" href="/Compositional/#9430" class="Function">var-inv</a> <a id="9438" class="Symbol">:</a> <a id="9440" class="Symbol">∀</a> <a id="9442" class="Symbol">{</a><a id="9443" href="/Compositional/#9443" class="Bound">Γ</a> <a id="9445" href="/Compositional/#9445" class="Bound">v</a> <a id="9447" href="/Compositional/#9447" class="Bound">x</a><a id="9448" class="Symbol">}</a> <a id="9450" class="Symbol">{</a><a id="9451" href="/Compositional/#9451" class="Bound">γ</a> <a id="9453" class="Symbol">:</a> <a id="9455" href="/Denotational/#7331" class="Function">Env</a> <a id="9459" href="/Compositional/#9443" class="Bound">Γ</a><a id="9460" class="Symbol">}</a>
  <a id="9464" class="Symbol">→</a> <a id="9466" href="/Denotational/#18334" class="Function">ℰ</a> <a id="9468" class="Symbol">(</a><a id="9469" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="9471" href="/Compositional/#9447" class="Bound">x</a><a id="9472" class="Symbol">)</a> <a id="9474" href="/Compositional/#9451" class="Bound">γ</a> <a id="9476" href="/Compositional/#9445" class="Bound">v</a>
    <a id="9482" class="Comment">-------------------</a>
  <a id="9504" class="Symbol">→</a> <a id="9506" href="/Compositional/#9445" class="Bound">v</a> <a id="9508" href="/Denotational/#4468" class="Datatype Operator">⊑</a> <a id="9510" href="/Compositional/#9451" class="Bound">γ</a> <a id="9512" href="/Compositional/#9447" class="Bound">x</a>
<a id="9514" href="/Compositional/#9430" class="Function">var-inv</a> <a id="9522" class="Symbol">(</a><a id="9523" href="/Denotational/#9910" class="InductiveConstructor">var</a><a id="9526" class="Symbol">)</a> <a id="9528" class="Symbol">=</a> <a id="9530" href="/Denotational/#5638" class="Function">Refl⊑</a>
<a id="9536" href="/Compositional/#9430" class="Function">var-inv</a> <a id="9544" class="Symbol">(</a><a id="9545" href="/Denotational/#10326" class="InductiveConstructor">⊔-intro</a> <a id="9553" href="/Compositional/#9553" class="Bound">d₁</a> <a id="9556" href="/Compositional/#9556" class="Bound">d₂</a><a id="9558" class="Symbol">)</a> <a id="9560" class="Symbol">=</a> <a id="9562" href="/Denotational/#4527" class="InductiveConstructor">ConjL⊑</a> <a id="9569" class="Symbol">(</a><a id="9570" href="/Compositional/#9430" class="Function">var-inv</a> <a id="9578" href="/Compositional/#9553" class="Bound">d₁</a><a id="9580" class="Symbol">)</a> <a id="9582" class="Symbol">(</a><a id="9583" href="/Compositional/#9430" class="Function">var-inv</a> <a id="9591" href="/Compositional/#9556" class="Bound">d₂</a><a id="9593" class="Symbol">)</a>
<a id="9595" href="/Compositional/#9430" class="Function">var-inv</a> <a id="9603" class="Symbol">(</a><a id="9604" href="/Denotational/#10462" class="InductiveConstructor">sub</a> <a id="9608" href="/Compositional/#9608" class="Bound">d</a> <a id="9610" href="/Compositional/#9610" class="Bound">lt</a><a id="9612" class="Symbol">)</a> <a id="9614" class="Symbol">=</a> <a id="9616" href="/Denotational/#4765" class="InductiveConstructor">Trans⊑</a> <a id="9623" href="/Compositional/#9610" class="Bound">lt</a> <a id="9626" class="Symbol">(</a><a id="9627" href="/Compositional/#9430" class="Function">var-inv</a> <a id="9635" href="/Compositional/#9608" class="Bound">d</a><a id="9636" class="Symbol">)</a>
<a id="9638" href="/Compositional/#9430" class="Function">var-inv</a> <a id="9646" href="/Denotational/#10251" class="InductiveConstructor">⊥-intro</a> <a id="9654" class="Symbol">=</a> <a id="9656" href="/Denotational/#4503" class="InductiveConstructor">Bot⊑</a></pre>

<p>To round-out the semantic equations, we establish the following one
for variables.</p>

<pre class="Agda"><a id="var-equiv"></a><a id="9770" href="/Compositional/#9770" class="Function">var-equiv</a> <a id="9780" class="Symbol">:</a> <a id="9782" class="Symbol">∀{</a><a id="9784" href="/Compositional/#9784" class="Bound">Γ</a><a id="9785" class="Symbol">}{</a><a id="9787" href="/Compositional/#9787" class="Bound">γ</a> <a id="9789" class="Symbol">:</a> <a id="9791" href="/Denotational/#7331" class="Function">Env</a> <a id="9795" href="/Compositional/#9784" class="Bound">Γ</a><a id="9796" class="Symbol">}{</a><a id="9798" href="/Compositional/#9798" class="Bound">x</a> <a id="9800" class="Symbol">:</a> <a id="9802" href="/Compositional/#9784" class="Bound">Γ</a> <a id="9804" href="/Untyped/#3365" class="Datatype Operator">∋</a> <a id="9806" href="/Untyped/#2694" class="InductiveConstructor">★</a><a id="9807" class="Symbol">}</a>
          <a id="9819" class="Symbol">→</a> <a id="9821" href="/Denotational/#18334" class="Function">ℰ</a> <a id="9823" class="Symbol">(</a><a id="9824" href="/Untyped/#4186" class="InductiveConstructor Operator">`</a> <a id="9826" href="/Compositional/#9798" class="Bound">x</a><a id="9827" class="Symbol">)</a> <a id="9829" href="/Denotational/#18532" class="Function Operator">≃</a> <a id="9831" class="Symbol">(λ</a> <a id="9834" href="/Compositional/#9834" class="Bound">γ</a> <a id="9836" href="/Compositional/#9836" class="Bound">v</a> <a id="9838" class="Symbol">→</a> <a id="9840" href="/Compositional/#9836" class="Bound">v</a> <a id="9842" href="/Denotational/#4468" class="Datatype Operator">⊑</a> <a id="9844" href="/Denotational/#8180" class="Function">nth</a> <a id="9848" href="/Compositional/#9798" class="Bound">x</a> <a id="9850" href="/Compositional/#9834" class="Bound">γ</a><a id="9851" class="Symbol">)</a>
<a id="9853" href="/Compositional/#9770" class="Function">var-equiv</a> <a id="9863" class="Symbol">=</a> <a id="9865" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="9867" href="/Compositional/#9430" class="Function">var-inv</a> <a id="9875" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="9877" class="Symbol">(λ</a> <a id="9880" href="/Compositional/#9880" class="Bound">lt</a> <a id="9883" class="Symbol">→</a> <a id="9885" href="/Denotational/#10462" class="InductiveConstructor">sub</a> <a id="9889" href="/Denotational/#9910" class="InductiveConstructor">var</a> <a id="9893" href="/Compositional/#9880" class="Bound">lt</a><a id="9895" class="Symbol">)</a> <a id="9897" href="https://agda.github.io/agda-stdlib/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a></pre>

  </div>

  <p style="text-align:center;">
    
    <a alt="Previous chapter" href="/Denotational/">Prev</a>
    &bullet;
    
    
    <a alt="Source code" href="https://github.com/plfa/plfa.github.io/blob/dev/src/plfa/Compositional.lagda">Source</a>
    
    
    &bullet;
    <a alt="Next chapter" href="/Soundness/">Next</a>
    
</p>


</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Programming Language Foundations in Agda
</h2><div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Philip Wadler</li>
          <li><a class="u-email" href="mailto:wadler@inf.ed.ac.uk">wadler@inf.ed.ac.uk</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wadler"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wadler</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3"></div>
    </div><div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Wen Kokke</li>
          <li><a class="u-email" href="mailto:wen.kokke@ed.ac.uk">wen.kokke@ed.ac.uk</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wenkokke"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wenkokke</span></a></li><li><a href="https://www.twitter.com/wenkokke"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">wenkokke</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3"></div>
    </div>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
  </div>
</footer>
<!-- Import jQuery -->
<script type="text/javascript" src="/assets/jquery.js"></script>

<!-- Script which allows for foldable code blocks -->
<script type="text/javascript">
 $('div.foldable pre').each(function(){
     var autoHeight = $(this).height();
     var lineHeight = parseFloat($(this).css('line-height'));

     var plus    = $("<div></div>");
     var horLine = $("<div></div>");
     var verLine = $("<div></div>");
     $(this).prepend(plus);
     plus.css({
         'position'         : 'relative',
         'float'            : 'right',
         'right'            : '-' + (0.5 * lineHeight - 1.5) + 'px',
         'width'            : lineHeight,
         'height'           : lineHeight});
     verLine.css({
         'position'         : 'relative',
         'height'           : lineHeight,
         'width'            : '3px',
         'background-color' : '#C1E0FF'});
     horLine.css({
         'position'         : 'relative',
         'top'              : '-' + (0.5 * lineHeight + 1.5) + 'px',
         'left'             : '-' + (0.5 * lineHeight - 1.5) + 'px',
         'height'           : '3px',
         'width'            : lineHeight,
         'background-color' : '#C1E0FF'});
     plus.append(verLine);
     plus.append(horLine);

     $(this).height(2.0 * lineHeight);
     $(this).css('overflow','hidden');

     $(this).click(function(){
         if ($(this).height() == autoHeight) {
             $(this).height(2.0 * lineHeight);
             plus.show();
         }
         else {
             $(this).height('auto');
             plus.hide();
         }
     });
 });
</script>

<!-- Import KaTeX -->
<script type="text/javascript" src="/assets/katex.js"></script>

<!-- Script which renders TeX using KaTeX -->
<script type="text/javascript">
 $("script[type='math/tex']").replaceWith(
     function(){
         var tex = $(this).text();
         return "<span class=\"inline-equation\">" +
                katex.renderToString(tex) +
                "</span>";
     });
 $("script[type='math/tex; mode=display']").replaceWith(
     function(){
         var tex = $(this).text().replace(/%.*?(\n|$)/g,"");
         return "<div class=\"equation\">" +
                katex.renderToString("\\displaystyle "+tex) +
                "</div>";
     });
</script>
</body>

</html>
